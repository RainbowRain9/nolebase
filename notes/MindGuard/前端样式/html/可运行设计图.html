<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>心语精灵 · 设计系统原型（Light/Dark/晚安/考试周）</title>
  <style>
    /* =======================
       Design Tokens（默认·安心）
       ======================= */
    :root {
      /* Brand & Neutral */
      --color-brand-50:#EEF5FF;
      --color-brand-100:#D9E8FF;
      --color-brand-200:#BFD6FF;
      --color-brand-300:#9AC0FF;
      --color-brand-400:#6FA4FF;
      --color-brand-500:#3A7BD5;
      --color-brand-600:#2E6FE6;
      --color-brand-700:#2558B8;
      --color-brand-800:#1E4791;
      --color-brand-900:#16356A;

      --color-ink-0:#F7F9FC;
      --color-ink-50:#F2F4F8;
      --color-ink-100:#E9EDF3;
      --color-ink-200:#D7DEE7;
      --color-ink-300:#C5CEDA;
      --color-ink-400:#9AA6B2;
      --color-ink-500:#7B8893;
      --color-ink-600:#5A6672;
      --color-ink-700:#434E5A;
      --color-ink-800:#2C3640;
      --color-ink-900:#1B232B;

      /* Accent */
      --color-lavender-500:#8C86FF; /* 信息型/插画 */
      --color-mint-500:#2AC28D;     /* 正向反馈 */

      /* Semantic */
      --color-info-50:#EEF5FF;
      --color-info-500:#3A7BD5;
      --color-info-600:#2E6FE6;

      --color-success-50:#EAFBF5;
      --color-success-500:#2AC28D;
      --color-success-600:#1FA476;

      --color-warning-50:#FFF6E8;
      --color-warning-500:#F2B23D;
      --color-warning-600:#D9961E;

      --color-danger-50:#FFEDEA;
      --color-danger-500:#E24C4B;
      --color-danger-600:#C23C3B;

      /* Risk levels */
      --color-risk-r1:#3A7BD5; /* 观察 */
      --color-risk-r2:#F59E0B; /* 关注 */
      --color-risk-r3:#F97316; /* 警戒 */
      --color-risk-r4:#DC2626; /* 升级 */

      /* Mood tags */
      --mood-calm:#5AA6A6;
      --mood-joy:#F5A97F;
      --mood-focus:#7C86FF;
      --mood-sad:#8BA3C7;
      --mood-anger:#E57A74;
      --mood-anxiety:#C9A86A;
      --mood-fatigue:#92A1B0;

      /* Surfaces / Text */
      --page-bg: var(--color-ink-0);
      --surface: #FFFFFF;
      --text-1: #1B232B; /* 主 */
      --text-2: #5A6672; /* 次 */
      --text-3: #7B8893; /* 辅助 */
      --divider: var(--color-ink-200);

      /* Component */
      --radius: 12px;
      --radius-sm: 8px;
      --shadow-1: 0 2px 8px rgba(0,0,0,.06);
      --shadow-2: 0 6px 16px rgba(0,0,0,.10);
      --focus-outline: 2px solid var(--color-brand-600);

      /* Motion */
      --dur-fast: 120ms;
      --dur-base: 200ms;
      --dur-slow: 360ms;
    }

    /* 暗色主题（晚间/暗室） */
    [data-theme="dark"] {
      --page-bg:#0F141A;
      --surface:#161B22;
      --text-1:#D1D7E0;
      --text-2:#9AA6B2;
      --text-3:#7B8893;
      --divider:#222A33;

      /* 关键对位 */
      --color-brand-500:#6096FF; /* 提升亮度保证对比 */
      --color-danger-500:#FF6B6B; /* 危险色在暗色更通透 */

      --shadow-1: 0 2px 8px rgba(0,0,0,.35);
      --shadow-2: 0 10px 24px rgba(0,0,0,.45);
    }
    /* 晚安模式：在暗色基础上降低饱和度与动效速度 */
    [data-theme="night"] {
      --page-bg:#0F141A;
      --surface:#161B22;
      --text-1:#D1D7E0;
      --text-2:#9AA6B2;
      --text-3:#7B8893;
      --divider:#222A33;
      --color-brand-500:#6A9FFF; /* 比暗色更柔和一点 */
      --color-danger-500:#FF7D7D;
      --dur-base: 280ms;
      --dur-slow: 420ms;
      filter: saturate(0.9);
    }
    /* 考试周主题（专注绿调）：将辅助色临时替换为柔和绿，弱化分心 */
    [data-theme="exam"] {
      --color-lavender-500:#5CA58C; /* 替换为专注绿调 */
      --color-mint-500:#2AC28D;     /* 保持正向反馈一致 */
    }

    /* 基础 Reset */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--page-bg);
      color: var(--text-1);
      font: 14px/1.6 system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Noto Sans CJK SC", "Microsoft YaHei", Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background var(--dur-base) ease, color var(--dur-base) ease, filter var(--dur-slow) ease;
    }
    h1,h2,h3 { margin: 0 0 8px; font-weight: 600; }
    h1 { font-size: 20px; }
    h2 { font-size: 16px; color: var(--text-2); }
    p { margin: 0 0 8px; color: var(--text-2); }
    a { color: var(--color-brand-600); text-decoration: none; }
    a:focus-visible, button:focus-visible { outline: var(--focus-outline); outline-offset: 2px; border-radius: 6px; }
    .container { padding: 16px; }

    /* 顶部工具条（主题切换） */
    .topbar {
      position: sticky; top: 0; z-index: 20;
      display: flex; align-items: center; gap: 12px;
      padding: 10px 16px;
      background: var(--surface);
      border-bottom: 1px solid var(--divider);
      box-shadow: var(--shadow-1);
    }
    .brand { display: flex; align-items: center; gap: 10px; }
    .logo {
      width: 28px; height: 28px; border-radius: 8px;
      background: linear-gradient(160deg, var(--color-brand-500), var(--color-lavender-500));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.25);
    }
    .topbar .title { font-weight: 700; }
    .themes {
      margin-left: auto; display: flex; gap: 8px; align-items: center; flex-wrap: wrap;
    }
    .seg {
      display: inline-flex; background: var(--color-ink-50); border-radius: 999px; padding: 4px;
      border: 1px solid var(--divider);
    }
    .seg button {
      border: 0; background: transparent; padding: 6px 10px; border-radius: 999px; cursor: pointer;
      color: var(--text-2); transition: background var(--dur-fast) ease, color var(--dur-fast) ease, transform var(--dur-fast);
    }
    .seg button[aria-pressed="true"] {
      background: var(--color-brand-50); color: var(--color-brand-700);
      box-shadow: inset 0 0 0 1px var(--color-brand-200);
    }
    .seg button:active { transform: scale(.98); }

    /* 页面容器与卡片 */
    .page { display: none; padding-bottom: 84px; } /* 为底部导航留出空间 */
    .page.active { display: block; }
    .card {
      background: var(--surface); border: 1px solid var(--divider); border-radius: var(--radius); padding: 14px;
      box-shadow: var(--shadow-1);
    }
    .card + .card { margin-top: 12px; }

    /* 金刚区 */
    .grid {
      display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
    }
    .gi {
      display: flex; flex-direction: column; align-items: center; gap: 8px;
      background: var(--surface); border: 1px solid var(--divider); border-radius: 12px; padding: 12px 8px;
      transition: transform var(--dur-fast) ease, box-shadow var(--dur-fast) ease;
    }
    .gi:hover { transform: translateY(-1px); box-shadow: var(--shadow-2); }
    .gi .ico { width: 28px; height: 28px; border-radius: 8px; background: var(--color-brand-50); display: grid; place-items: center; }
    .gi .ico svg { width: 18px; height: 18px; }
    .gi span { font-size: 12px; color: var(--text-2); }

    /* 按钮 */
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      border-radius: 12px; padding: 10px 14px; border: 1px solid transparent; cursor: pointer;
      font-weight: 600; transition: background var(--dur-fast), border-color var(--dur-fast), color var(--dur-fast), transform var(--dur-fast);
    }
    .btn:active { transform: translateY(1px); }
    .btn.primary { background: var(--color-brand-500); color: #fff; }
    .btn.primary:hover { background: var(--color-brand-600); }
    .btn.secondary { background: transparent; border-color: var(--color-brand-300); color: var(--color-brand-600); }
    .btn.secondary:hover { background: var(--color-brand-50); }

    /* 徽章 & 提示卡（语义色） */
    .badge { display: inline-flex; align-items: center; gap: 6px; padding: 2px 8px; border-radius: 999px; font-size: 12px; }
    .i { background: var(--color-info-50); color: var(--color-info-600); }
    .s { background: var(--color-success-50); color: var(--color-success-600); }
    .w { background: var(--color-warning-50); color: var(--color-warning-600); }
    .d { background: var(--color-danger-50); color: var(--color-danger-600); }
    .alert {
      border-left: 4px solid; padding: 10px 12px; border-radius: 10px; background: var(--surface); border: 1px solid var(--divider);
      display: flex; gap: 10px; align-items: flex-start;
    }
    .alert.i { border-left-color: var(--color-info-500); }
    .alert.s { border-left-color: var(--color-success-500); }
    .alert.w { border-left-color: var(--color-warning-500); }
    .alert.d { border-left-color: var(--color-danger-500); }

    /* 风险色阶（论坛/SOS） */
    .risk { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; font-weight:600; color: #fff; }
    .r1 { background: var(--color-risk-r1); }
    .r2 { background: var(--color-risk-r2); }
    .r3 { background: var(--color-risk-r3); }
    .r4 { background: var(--color-risk-r4); }

    /* 行动任务卡（行为闭环） */
    .task {
      display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center;
      border: 1px solid var(--divider); border-radius: var(--radius); padding: 12px; background: var(--surface);
    }
    .task.done { background: var(--success-bg, var(--color-success-50)); }
    .task small { color: var(--text-3); }

    /* 心情标签（心情轮） */
    .moods { display: flex; flex-wrap: wrap; gap: 8px; }
    .mood { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border-radius: 999px; color: #fff; font-weight:600; }
    .m-calm{ background: var(--mood-calm); } .m-joy{ background: var(--mood-joy); } .m-focus{ background: var(--mood-focus); }
    .m-sad{ background: var(--mood-sad); } .m-anger{ background: var(--mood-anger); } .m-anxiety{ background: var(--mood-anxiety); }
    .m-fatigue{ background: var(--mood-fatigue); }

    /* 列表 & 项 */
    .list { display: grid; gap: 10px; }
    .item { display: grid; gap: 6px; padding: 12px; border-radius: 12px; border:1px solid var(--divider); background: var(--surface); }
    .meta { display: flex; gap: 8px; align-items:center; color: var(--text-3); }
    .meta .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--divider); }

    /* 底部导航 */
    .tabbar {
      position: fixed; bottom: 0; left: 0; right: 0; z-index: 30;
      display: grid; grid-template-columns: repeat(5,1fr); gap: 6px; padding: 8px 12px;
      background: var(--surface); border-top: 1px solid var(--divider);
    }
    .tab {
      display:flex; flex-direction: column; align-items:center; gap:4px; padding:8px 4px; border-radius: 10px; color: var(--text-2);
      cursor: pointer; user-select: none; transition: background var(--dur-fast), color var(--dur-fast);
    }
    .tab[aria-selected="true"] { color: var(--color-brand-600); background: var(--color-brand-50); }
    .tab svg { width: 20px; height: 20px; }

    /* SOS Button（按压态叠加 8% 黑蒙层） */
    .sos {
      position: relative; display: inline-flex; align-items:center; gap:8px;
      background: var(--color-risk-r4); color: #fff; padding: 12px 16px; border-radius: 999px; border: 0; cursor: pointer; font-weight: 800;
      box-shadow: 0 6px 18px rgba(220,38,38,.25);
    }
    .sos:active::after {
      content:""; position:absolute; inset:0; border-radius:999px; background: rgba(0,0,0,.08);
    }

    /* 可访问性：链接悬停/焦点、图标与文案共现 */
    .ico-only { position: relative; }
    .ico-only .sr { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }

    /* 空间微调 */
    .mt8{margin-top:8px;} .mt12{margin-top:12px;} .mt16{margin-top:16px;}
    .row{display:flex; align-items:center; gap:10px; flex-wrap: wrap;}
    .sp-between{display:flex; justify-content:space-between; align-items:center;}
  </style>
</head>
<body data-theme="light">
  <header class="topbar" role="banner">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div class="title">心语精灵 · 心理辅导（设计预览）</div>
    </div>
    <div class="themes" role="toolbar" aria-label="主题切换">
      <div class="seg" role="group" aria-label="主题">
        <button class="tbtn" data-theme="light" aria-pressed="true">默认</button>
        <button class="tbtn" data-theme="dark" aria-pressed="false">暗色</button>
        <button class="tbtn" data-theme="night" aria-pressed="false">晚安</button>
        <button class="tbtn" data-theme="exam" aria-pressed="false">考试周</button>
      </div>
    </div>
  </header>

  <!-- 今天 -->
  <main id="page-today" class="page active" role="main">
    <div class="container">
      <!-- 风险提示条（示例：R2 关注） -->
      <div class="card" style="display:flex; align-items:center; gap:10px;">
        <span class="risk r2">R2 · 关注</span>
        <div style="flex:1;">
          <strong>近3天“失眠+自责”词频上升</strong>
          <p class="mt8">建议：今晚先做 5 分钟呼吸练习，明早补一次晨光散步。<span class="badge i">由情绪侦测生成</span></p>
        </div>
        <button class="btn secondary">查看</button>
      </div>

      <!-- 工具箱（金刚区） -->
      <h1 class="mt16">工具箱</h1>
      <p>把 AI 对话当作引擎，其余能力围绕“闭环与守护”展开。</p>
      <div class="grid mt12" role="navigation" aria-label="工具箱">
        <!-- 每个图标采用语义+图标双通道 -->
        <div class="gi" tabindex="0"><div class="ico" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2"/></svg>
        </div><span>AI对话</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="7" r="3" stroke="currentColor" stroke-width="2"/><path d="M4 20c2-4 14-4 16 0" stroke="currentColor" stroke-width="2"/></svg></div><span>心情签到</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><rect x="3" y="4" width="18" height="4" rx="2" stroke="currentColor" stroke-width="2"/><path d="M6 12h12M6 16h8" stroke="currentColor" stroke-width="2"/></svg></div><span>清单</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><path d="M12 3v18M3 12h18" stroke="currentColor" stroke-width="2"/></svg></div><span>呼吸练习</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><path d="M4 7h16M4 12h16M4 17h10" stroke="currentColor" stroke-width="2"/></svg></div><span>学习计划</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><path d="M12 21c4-3 8-6.5 8-11a8 8 0 0 0-16 0c0 4.5 4 8 8 11Z" stroke="currentColor" stroke-width="2"/></svg></div><span>树洞</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><rect x="4" y="4" width="16" height="16" rx="4" stroke="currentColor" stroke-width="2"/><path d="M8 12h8" stroke="currentColor" stroke-width="2"/></svg></div><span>小测评</span></div>
        <div class="gi" tabindex="0"><div class="ico"><svg viewBox="0 0 24 24" fill="none"><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/></svg></div><span>冥想计时</span></div>
      </div>

      <!-- 行动任务卡（行为闭环） -->
      <h2 class="mt16">今日任务</h2>
      <div class="task">
        <div>
          <strong>整理书桌 10 分钟</strong><br>
          <small>步骤：收纳杂纸→清洁台面→摆好笔记本</small>
        </div>
        <button class="btn primary" onclick="markDone(this)">去完成</button>
      </div>
      <div class="alert i mt12">
        <div class="ico-only" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M12 7v6M12 17h.01" stroke="currentColor" stroke-width="2"/></svg>
        </div>
        <div>
          <strong>提示：</strong> 任务完成后，T+1 将回访你的感受并更新建议排序（不骚扰的提醒策略）。
        </div>
      </div>

      <!-- SOS -->
      <div class="row mt16">
        <button class="sos" onclick="alert('已记录请求，进入 3 步安全指引；可匿名转接校内/公益热线。')">
          <svg viewBox="0 0 24 24" fill="none" width="18" height="18" aria-hidden="true">
            <path d="M12 3l9 6v6l-9 6-9-6V9l9-6Z" stroke="currentColor" stroke-width="2"/></svg>
          SOS 紧急支持
        </button>
        <span class="badge d">仅在高危或不可逆操作时使用红色</span>
      </div>
    </div>
  </main>

  <!-- 心情随笔清单 -->
  <section id="page-task" class="page" aria-label="任务看板">
    <div class="container">
      <h1>任务清单执行</h1>
      <p>集中管理 AI 建议、树洞领取、真人指派与自建任务，支持番茄计时与复盘。</p>

      <div class="row mt12" role="tablist" aria-label="来源筛选">
        <span class="badge i">全部</span>
        <span class="badge">AI 建议</span>
        <span class="badge">树洞</span>
        <span class="badge">真人协同</span>
        <span class="badge">自建</span>
      </div>

      <div class="card mt16" aria-live="polite">
        <div class="sp-between">
          <div>
            <strong>今日概览</strong>
            <p class="mt8">进行中 <strong>2</strong> · 已完成 <span class="badge s">3</span> · 延期 <span class="badge w">1</span></p>
          </div>
          <button class="btn secondary" onclick="document.getElementById('page-task-stats').classList.toggle('open')">查看统计</button>
        </div>
      </div>

      <div class="list mt16">
        <div class="task">
          <div class="sp-between">
            <strong>深呼吸练习 5 分钟</strong>
            <span class="badge i">AI 建议</span>
          </div>
          <p>完成后记录情绪变化，若仍紧绷可联系 ASK 助理。</p>
          <div class="meta"><span>情绪：焦虑 · 社交场景</span><span class="dot"></span><span>番茄 5'</span></div>
          <div class="actions"><button class="btn primary" onclick="markDone(this)">开始番茄</button></div>
        </div>
        <div class="task done">
          <div class="sp-between">
            <strong>和室友聊聊寝室卫生</strong>
            <span class="badge">真人指派</span>
          </div>
          <p>完成后在周报中补充反馈，便于辅导员跟进。</p>
          <div class="meta"><span>情绪：沟通</span><span class="dot"></span><span>用时 15'</span></div>
          <div class="actions"><button class="btn secondary">已完成</button></div>
        </div>
        <div class="task">
          <div class="sp-between">
            <strong>整理书桌 10 分钟</strong>
            <span class="badge">自建任务</span>
          </div>
          <p>保持学习区整洁，结束后记得写一句感受。</p>
          <div class="meta"><span>情绪：专注</span><span class="dot"></span><span>提醒 20:30</span></div>
          <div class="actions"><button class="btn secondary">稍后提醒</button></div>
        </div>
      </div>

      <div id="page-task-stats" class="card mt16" aria-hidden="true">
        <strong>来源完成度</strong>
        <p class="mt8">AI 80% · 树洞 60% · 真人 75% · 自建 50%</p>
      </div>
    </div>
  </section>
  <section id="page-diary" class="page" aria-label="心情随笔">
    <div class="container">
      <h1>心情随笔与情绪</h1>
      <div class="moods mt8">
        <span class="mood m-calm">平静</span>
        <span class="mood m-joy">喜悦</span>
        <span class="mood m-focus">专注</span>
        <span class="mood m-sad">悲伤</span>
        <span class="mood m-anger">愤怒</span>
        <span class="mood m-anxiety">焦虑</span>
        <span class="mood m-fatigue">倦怠</span>
      </div>

      <div class="list mt16">
        <div class="item">
          <div class="sp-between">
            <strong>9/10 周三 · 复习效率不错</strong>
            <span class="badge s">完成回执</span>
          </div>
          <p>用 2 轮番茄完成了高数例题，晚饭后散步 15 分钟。</p>
          <div class="meta"><span>情绪：专注</span><span class="dot"></span><span>压力：3/10</span></div>
        </div>
        <div class="item">
          <div class="sp-between">
            <strong>9/09 周二 · 心有点乱</strong>
            <span class="badge w">提醒已顺延</span>
          </div>
          <p>和室友有点误会，先写下想说的话，明天再沟通。</p>
          <div class="meta"><span>情绪：焦虑</span><span class="dot"></span><span>压力：6/10</span></div>
        </div>
      </div>

      <div class="row mt16">
        <button class="btn primary">新增随笔</button>
        <button class="btn secondary">情绪小结</button>
      </div>
    </div>
  </section>

  <!-- 树洞论坛 -->
  <section id="page-forum" class="page" aria-label="树洞论坛">
    <div class="container">
      <h1>树洞 · 安静表达</h1>
      <div class="alert w mt8">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 2L1 21h22L12 2Z" stroke="currentColor" stroke-width="2"/><path d="M12 9v5M12 17h.01" stroke="currentColor" stroke-width="2"/></svg>
        <div>发帖默认匿名且会脱敏处理；出现 R3/R4 信号仅通知授权岗位，最小必要信息原则。</div>
      </div>
      <div class="list mt12">
        <div class="item">
          <div class="sp-between">
            <strong>“感觉总被否定，还能坚持吗”</strong>
            <span class="risk r1">R1 观察</span>
          </div>
          <p>这周返修了三次，开始怀疑自己是不是不适合这个专业。</p>
          <div class="meta"><span>话题：学业</span><span class="dot"></span><span>情绪：悲伤</span></div>
        </div>
        <div class="item">
          <div class="sp-between">
            <strong>“今天好想对谁都发火”</strong>
            <span class="risk r3">R3 警戒</span>
          </div>
          <p>一直憋着，怕说重了后悔。</p>
          <div class="row mt8">
            <button class="btn secondary">给TA一个抱抱</button>
            <button class="btn primary">匿名留言</button>
          </div>
        </div>
      </div>
      <div class="row mt16">
        <button class="btn primary">我要发帖</button>
        <button class="btn secondary">我的贴子</button>
      </div>
    </div>
  </section>

  <!-- 我的 -->
  <section id="page-me" class="page" aria-label="我的">
    <div class="container">
      <h1>我的</h1>
      <div class="card">
        <div class="sp-between">
          <div>
            <strong>晨星 · 22级</strong>
            <p class="mt8">近 7 天：完成 6 项微任务 · 两次签到有改善</p>
          </div>
          <span class="badge s">趋势向好</span>
        </div>
      </div>
      <div class="card mt12">
        <h2>偏好与设置</h2>
        <div class="row mt8">
          <button class="btn secondary tbtn" data-theme="light">默认</button>
          <button class="btn secondary tbtn" data-theme="dark">暗色</button>
          <button class="btn secondary tbtn" data-theme="night">晚安</button>
          <button class="btn secondary tbtn" data-theme="exam">考试周</button>
        </div>
      </div>
      <div class="card mt12">
        <h2>通知与隐私</h2>
        <p class="mt8">提醒窗口：到期-15m/到期/宽限+30m（不骚扰顺延）</p>
        <p>隐私：默认匿名/化名；授权后再转交；所有查看行为写审计日志。</p>
      </div>
    </div>
  </section>

  <!-- 底部 TabBar -->
  <nav class="tabbar" role="tablist" aria-label="底部导航">
    <div class="tab" role="tab" aria-selected="true" aria-controls="page-today" data-target="page-today">
      <!-- 使用不同形状帮助色盲用户：房子实心 -->
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 11l9-7 9 7v9a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-4H9v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-9Z" stroke="currentColor" stroke-width="2"/></svg>
      <span>今天</span>
    </div>
    <div class="tab" role="tab" aria-selected="false" aria-controls="page-task" data-target="page-task">
      <!-- 清单图标 -->
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="4" y="3" width="16" height="18" rx="3" stroke="currentColor" stroke-width="2"/><path d="M8 8h8M8 12h6M8 16h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      <span>任务清单</span>
    </div>
    <div class="tab" role="tab" aria-selected="false" aria-controls="page-forum" data-target="page-forum">
      <!-- 聊天气泡 -->
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 12a8 8 0 1 0-3.4 6.5L21 21l-2-3.4A7.9 7.9 0 0 0 21 12Z" stroke="currentColor" stroke-width="2"/></svg>
      <span>树洞社区</span>
    </div>
    <div class="tab" role="tab" aria-selected="false" aria-controls="page-diary" data-target="page-diary">
      <!-- 心形轮廓 -->
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 21c4-3 8-6.5 8-11a5 5 0 0 0-9-3 5 5 0 0 0-9 3c0 4.5 4 8 10 11Z" stroke="currentColor" stroke-width="2"/></svg>
      <span>心情随笔</span>
    </div>
    <div class="tab" role="tab" aria-selected="false" aria-controls="page-me" data-target="page-me">
      <!-- 用户小人 -->
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="12" cy="7" r="3.5" stroke="currentColor" stroke-width="2"/><path d="M4 20c2.5-5 13.5-5 16 0" stroke="currentColor" stroke-width="2"/></svg>
      <span>我的</span>
    </div>
  </nav>

  <script>
    // 主题切换
    const buttons = document.querySelectorAll('.tbtn');
    const body = document.body;
    function setTheme(theme) {
      body.setAttribute('data-theme', theme);
      buttons.forEach(b => b.setAttribute('aria-pressed', String(b.dataset.theme === theme)));
      localStorage.setItem('xinyu-theme', theme);
    }
    buttons.forEach(b => b.addEventListener('click', () => setTheme(b.dataset.theme)));
    // 初始化主题
    const saved = localStorage.getItem('xinyu-theme');
    if(saved) setTheme(saved);

    // 底部导航切换
    const tabs = document.querySelectorAll('.tabbar .tab');
    const pages = document.querySelectorAll('.page');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
        tab.setAttribute('aria-selected', 'true');
        const id = tab.dataset.target;
        pages.forEach(p => p.classList.toggle('active', p.id === id));
        document.getElementById(id).scrollTo({top:0, behavior:'smooth'});
      });
    });

    // 行为闭环：任务完成示例
    function markDone(el){
      const task = el.closest('.task');
      task.classList.add('done');
      el.textContent = '已完成';
      el.classList.remove('primary'); el.classList.add('secondary');
    }

    // 减少动画的系统偏好
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.documentElement.style.setProperty('--dur-base','0ms');
      document.documentElement.style.setProperty('--dur-slow','0ms');
    }
  </script>
</body>
</html>

