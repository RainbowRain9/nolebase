# 页面：树洞 Tab

## 页面定位
树洞Tab是MindGuard的"校园心声社区"，承载"匿名分享×情绪互助×行动倡导"的核心功能。作为用户表达真实情感的安全空间，通过AI风险监测确保社区安全，将优质内容转化为行动建议，促进同伴支持与互助，同时建立完善的风险监测与干预机制。

## 核心模块与入口

### 模块1：发帖与风险自检
- **功能描述**：提供安全匿名的发帖环境，用户可分享情绪状态、寻求建议或讨论话题，系统自动进行风险自检与内容审核，确保社区安全。
- **涉及组件**：发帖编辑器、情绪温度条、风险自检器、匿名设置开关
- **交互说明**：
  - 支持添加"情绪温度条"直观显示当前情绪状态（1-10分刻度）
  - 风险自检：发布前自动进行AI风险扫描，高风险内容弹出"寻求帮助"提示
  - 完全匿名发帖，仅对系统可见身份信息
  - 发帖成功后可选择"生成行动卡"，将求助转化为具体行动建议

### 模块2：树洞列表与过滤
- **功能描述**：展示社区帖子列表，支持多种筛选和排序方式，帮助用户快速找到感兴趣的内容，同时保护用户隐私。
- **涉及组件**：帖子卡片组件、筛选器、排序器、风险等级标签
- **交互说明**：
  - 卡片式布局展示帖子摘要，包含情绪温度条、回复数、收藏数
  - 支持按时间、热度、情绪状态筛选
  - 高风险帖子R3/R4级别需要额外确认才能查看
  - 帖子状态管理：草稿、审核中、已发布、已归档

### 模块3：互动与支持系统
- **功能描述**：提供丰富的社区互动功能，包括抱抱、评论、收藏等，支持CBT引导回复，促进积极的互助氛围。
- **涉及组件**：互动按钮组、评论组件、CBT提示器、收藏管理
- **交互说明**：
  - 抱抱功能：快速表达关心和支持，显示抱抱数量
  - 智能评论建议：根据帖子内容提供CBT导向的回复建议
  - 收藏功能：支持收藏有价值的帖子供后续查看
  - 匿名互动：所有互动都在匿名状态下进行

### 模块4：行动卡生成与领取
- **功能描述**：将优质社区内容转化为实际行动建议，支持用户创建和领取行动卡，形成从讨论到行动的完整闭环。
- **涉及组件**：行动卡编辑器、行动卡展示组件、领取按钮、进度追踪
- **交互说明**：
  - 帖主可将优质回复转化为"行动卡"
  - 其他用户可领取行动卡并生成个人任务
  - 行动卡包含具体步骤、预计时间和难度等级
  - 支持行动卡完成情况的追踪和反馈

### 模块5：风险监测与守护
- **功能描述**：实时监测社区内容风险，建立多级响应机制，确保社区安全，为需要帮助的用户提供及时支持。
- **涉及组件**：风险监测器、守护工作台、预警系统、资源引导
- **交互说明**：
  - AI实时风险扫描，识别潜在的危机信号
  - 多级风险响应：R1观察、R2关注、R3警示、R4危急
  - 守护者工作台：专业人员处理高风险事件
  - 自动推送相关资源和支持信息

### 模块6：话题趋势与发现
- **功能描述**：展示社区热门话题和趋势，帮助用户发现感兴趣的内容，促进有意义的讨论和连接。
- **涉及组件**：话题云组件、趋势图表、发现推荐、热门榜单
- **交互说明**：
  - 话题云：可视化展示热门讨论话题，支持点击筛选
  - 趋势图表：显示社区情绪变化和话题热度趋势
  - 发现推荐：基于用户兴趣推荐相关话题和帖子
  - 热门榜单：展示最受关注和讨论的内容

### 模块7：社区规则与引导
- **功能描述**：提供社区行为准则和使用引导，帮助用户了解社区规范，促进健康积极的社区氛围。
- **涉及组件**：规则展示组件、引导提示、行为准则、举报功能
- **交互说明**：
  - 社区公约：明确展示社区行为准则和规范
  - 新手引导：首次使用时提供功能介绍和使用指导
  - 举报机制：支持用户举报不当内容，维护社区环境
  - 积分系统：通过积极参与获得积分，激励优质贡献

## AI / 协同逻辑

### AI风险识别与分类
- **内容风险分析**：自动分析帖子内容，识别潜在的自伤、抑郁、焦虑等风险信号
- **情绪状态评估**：基于文本内容分析用户情绪状态，判断需要支持的紧急程度
- **风险等级划分**：将识别到的风险分为4个等级，触发不同的响应机制
- **智能推荐干预**：根据风险等级和内容特征，推荐最合适的干预措施

### CBT智能引导
- **认知重构建议**：识别非理性思维模式，提供认知重构的引导建议
- **行为激活推荐**：基于情绪状态推荐合适的行动建议和行为激活策略
- **同伴支持匹配**：将有相似经历的用户进行匹配，促进同伴支持
- **专业介入时机**：判断何时需要专业心理咨询师介入，提供及时的专业支持

### 真人协同守护
- **守护者团队**：由专业的心理咨询师和辅导员组成守护者团队
- **分级响应机制**：根据风险等级启动不同级别的响应机制
- **线上线下联动**：线上监测预警，线下跟进支持，形成完整的守护网络
- **多方协作**：与学校心理健康中心、医院等专业机构建立协作关系

### 内容质量评估
- **价值内容识别**：自动识别具有帮助价值和启发性的优质内容
- **互动质量分析**：分析评论和回复的质量，促进有意义的交流
- **趋势预测**：基于历史数据预测社区话题趋势和用户需求变化
- **个性化推荐**：根据用户特征和行为习惯推荐相关内容

## 涉及组件

### 核心业务组件
- **PostEditor**：发帖编辑器，支持富文本编辑和风险自检
- **PostList**：帖子列表组件，展示社区内容
- **PostCard**：帖子卡片组件，显示单条帖子信息
- **InteractionPanel**：互动面板，提供抱抱、评论、收藏功能
- **ActionCard**：行动卡组件，管理行动建议生成和领取
- **RiskMonitor**：风险监测组件，实时分析内容风险
- **GuardianDashboard**：守护者工作台，处理高风险事件

### 交互组件
- **EmotionThermometer**：情绪温度条，可视化情绪状态
- **RiskIndicator**：风险指示器，显示风险等级
- **CommentEditor**：评论编辑器，支持CBT引导回复
- **FilterChips**：筛选芯片，支持多维度筛选
- **AnonymousToggle**：匿名开关，控制发帖匿名状态

### 数据组件
- **PostStats**：帖子统计组件，显示互动数据
- **TrendChart**：趋势图表，展示社区活跃度
- **UserReputation**：用户声誉系统，激励优质贡献
- **ContentModeration**：内容审核组件，管理帖子状态

### 引导组件
- **OnboardingGuide**：新手引导组件，介绍功能使用
- **CommunityRules**：社区规则展示组件
- **HelpCenter**：帮助中心，提供使用指导
- **FeedbackSystem**：反馈系统，收集用户意见

## 页面跳转关系

### 从树洞页跳出的链接
- **发帖详情** → 点击帖子卡片查看完整内容和互动记录
- **行动卡详情** → 点击行动卡查看具体执行步骤
- **任务生成** → 领取行动卡后跳转到任务页面
- **SOS求助** → 高风险内容触发SOS紧急求助
- **资源推荐** → 根据帖子内容推荐相关资源
- **个人主页** → 查看用户的历史发帖和互动记录
- **举报处理** → 举报不当内容进入处理流程
- **社区规则** → 查看详细的社区行为准则

### 跳转到树洞页的入口
- **今天Tab** → 社区动态卡片跳转到热门帖子
- **心情随笔** → 从随笔生成树洞发帖
- **任务Tab** → 任务完成后可在树洞分享经验
- **我的Tab** → 查看我的发帖和互动历史
- **SOS页面** → 从紧急求助状态转入社区支持

## 数据需求与埋点

### 数据来源
- **帖子数据**：`forum_posts`表，包含post_id、user_id、content、tags、mood_thermometer、risk_level、created_at
- **互动数据**：`forum_reactions`表，包含reaction_id、post_id、user_id、reaction_type、content、created_at
- **行动卡数据**：`action_cards`表，包含action_card_id、post_id、title、steps、estimated_duration_minutes、created_at
- **风险信号**：`risk_signals`表，记录风险识别和处理过程
- **用户行为数据**：`user_events`表，记录用户在社区的各种行为

### 关键API
- **`/api/forum/posts`**：创建树洞发帖、查询列表（含筛选/排序）
- **`/api/forum/reactions`**：记录抱抱、评论、收藏等互动行为
- **`/api/forum/action-cards`**：创建/领取行动卡，查询进度
- **`/api/forum/risk-monitor`**：获取风险识别结果和处理建议
- **`/api/forum/trending`**：获取热门话题和趋势分析
- **`/api/forum/moderation`**：内容审核和状态管理
- **`/api/forum/topics`**：获取话题分类和推荐内容
- **`/api/forum/analytics`**：获取社区数据分析结果

### 埋点事件
- **发帖行为埋点**：记录发帖触发、内容特征、风险等级等
- **互动行为埋点**：记录各种互动行为的类型、频率、效果
- **行动卡转化埋点**：记录从发帖到行动卡的转化路径
- **风险处理埋点**：记录风险识别、干预、处理的全过程
- **内容消费埋点**：记录用户浏览、筛选、搜索等行为
- **社区参与埋点**：记录用户在社区的活跃度和贡献度
- **功能使用埋点**：记录各功能模块的使用情况和效果
- **用户路径埋点**：记录用户在社区内的移动轨迹和偏好

