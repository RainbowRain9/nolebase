# åŠŸèƒ½-å®æ—¶é£é™©è¯„ä¼°

> ç‰ˆæœ¬ï¼šv1.0.0 | æ›´æ–°æ—¥æœŸï¼š2025-10-08
> å…³è”é¡µé¢ï¼šå¿ƒè¯­ç²¾çµå¯¹è¯ç•Œé¢ | å…³è”äº‘å‡½æ•°ï¼šaskMessageManagerã€sosRelay

## åŠŸèƒ½æ¦‚è¿°

å®æ—¶é£é™©è¯„ä¼°åŠŸèƒ½æ˜¯å¿ƒè¯­ç²¾çµå¯¹è¯ç³»ç»Ÿçš„å®‰å…¨ä¿éšœæ ¸å¿ƒï¼Œé€šè¿‡å¤šå±‚æ¬¡çš„é£é™©è¯†åˆ«æ¨¡å‹ï¼Œå®æ—¶ç›‘æ§ç”¨æˆ·å¯¹è¯ä¸­çš„æ½œåœ¨é£é™©ä¿¡å·ï¼ŒåŠæ—¶è§¦å‘é¢„è­¦æœºåˆ¶ï¼Œä¸ºç”¨æˆ·æä¾›å¿…è¦çš„å®‰å…¨ä¿éšœå’Œä¸“ä¸šæ”¯æŒã€‚

## è®¾è®¡ç†å¿µ

- **å®‰å…¨ä¼˜å…ˆ**ï¼šä»¥ç”¨æˆ·å®‰å…¨ä¸ºé¦–è¦åŸåˆ™ï¼Œå®å¯è¯¯æŠ¥ä¹Ÿä¸æ¼æŠ¥
- **åŠæ—¶å“åº”**ï¼šå®æ—¶é£é™©ç›‘æ§ï¼Œå¿«é€Ÿå“åº”ç´§æ€¥æƒ…å†µ
- **åˆ†çº§å¤„ç†**ï¼šæ ¹æ®é£é™©ç­‰çº§åˆ¶å®šç›¸åº”çš„å“åº”ç­–ç•¥
- **ä¸“ä¸šæ”¯æŒ**ï¼šè¿æ¥ä¸“ä¸šå¿ƒç†æ”¯æŒèµ„æºï¼Œæä¾›æœ‰æ•ˆå¸®åŠ©

## é£é™©è¯„ä¼°ä½“ç³»

### é£é™©ç­‰çº§å®šä¹‰

#### 0çº§ - æ— é£é™© (No Risk)
**ç‰¹å¾**ï¼š
- æ—¥å¸¸æƒ…ç»ªè¡¨è¾¾ã€æ­£å¸¸å¿ƒç†çŠ¶æ€
- æ— ä»»ä½•è‡ªä¼¤æˆ–ä»–ä¼¤æ„å›¾
- ç§¯ææˆ–ä¸­æ€§çš„è¡¨è¾¾å†…å®¹

**åˆ¤æ–­æ ‡å‡†**ï¼š
- ä¸åŒ…å«ä»»ä½•é£é™©å…³é”®è¯
- æƒ…ç»ªçŠ¶æ€æ­£å¸¸æˆ–è½»å¾®è´Ÿé¢
- æœ‰æ˜ç¡®çš„æ”¯æŒç³»ç»Ÿå’Œåº”å¯¹ç­–ç•¥

**å“åº”ç­–ç•¥**ï¼š
- æ­£å¸¸å¯¹è¯æµç¨‹
- æä¾›å¸¸è§„å¿ƒç†æ”¯æŒ
- æ— éœ€ç‰¹æ®Šå¹²é¢„

#### 1çº§ - è½»åº¦é£é™© (Mild Risk)
**ç‰¹å¾**ï¼š
- å¶å‘è´Ÿé¢æƒ…ç»ªè¡¨è¾¾
- è½»å¾®çš„å‹åŠ›æˆ–å›°æ‰°
- æœ‰æ¸…æ™°çš„ä¿æŠ¤å› ç´ 

**åˆ¤æ–­æ ‡å‡†**ï¼š
- åŒ…å«è½»å¾®è´Ÿé¢è¯æ±‡ä½†æ— å…·ä½“ä¼¤å®³æ„å›¾
- æœ‰æ˜ç¡®çš„æ”¯æŒæ¥æºï¼ˆå®¶äººã€æœ‹å‹ç­‰ï¼‰
- è¡¨è¾¾å¯»æ±‚å¸®åŠ©çš„æ„æ„¿

**ç¤ºä¾‹è¡¨è¾¾**ï¼š
- "æœ€è¿‘æœ‰ç‚¹å‹åŠ›å¤§"
- "å¿ƒæƒ…ä¸å¤ªå¥½ï¼Œä½†ä¼šè¿‡å»çš„"
- "å’Œæœ‹å‹èŠèŠå°±å¥½äº†"

**å“åº”ç­–ç•¥**ï¼š
- æä¾›æƒ…ç»ªæ”¯æŒå»ºè®®
- é¼“åŠ±å¯»æ±‚ç¤¾ä¼šæ”¯æŒ
- ç›‘æ§å¯¹è¯å‘å±•

#### 2çº§ - ä¸­åº¦é£é™© (Moderate Risk)
**ç‰¹å¾**ï¼š
- åå¤å‡ºç°çš„è´Ÿé¢æƒ…ç»ª
- ç»æœ›ã€æ— åŠ©æ„Ÿè¡¨è¾¾
- å­˜åœ¨éƒ¨åˆ†ä¿æŠ¤å› ç´ 

**åˆ¤æ–­æ ‡å‡†**ï¼š
- å¤šæ¬¡è¡¨è¾¾è´Ÿé¢æƒ…ç»ªä½†æ— å…·ä½“è®¡åˆ’
- æåŠç»æœ›ã€æ— æ„ä¹‰æ„Ÿä½†ç¼ºä¹è¡ŒåŠ¨æ„å›¾
- æœ‰ä¸€å®šçš„æ”¯æŒç³»ç»Ÿä½†åˆ©ç”¨ä¸è¶³

**ç¤ºä¾‹è¡¨è¾¾**ï¼š
- "æ´»ç€æ²¡ä»€ä¹ˆæ„æ€"
- "æ„Ÿè§‰åšä»€ä¹ˆéƒ½æ²¡ç”¨"
- "æ²¡æœ‰äººç†è§£æˆ‘"

**å“åº”ç­–ç•¥**ï¼š
- ä¸»åŠ¨æä¾›ä¸“ä¸šèµ„æº
- å¢åŠ å…³æ³¨é¢‘ç‡
- å»ºè®®å¯»æ±‚ä¸“ä¸šå¸®åŠ©

#### 3çº§ - é«˜åº¦é£é™© (High Risk)
**ç‰¹å¾**ï¼š
- å¼ºçƒˆçš„è‡ªä¼¤æ„å›¾
- æœ‰æ¨¡ç³Šçš„è¡ŒåŠ¨è®¡åˆ’
- è‡ªæˆ‘ä¿æŠ¤èƒ½åŠ›ä¸è¶³

**åˆ¤æ–­æ ‡å‡†**ï¼š
- æ˜ç¡®è¡¨è¾¾è‡ªä¼¤æƒ³æ³•
- æåŠæ–¹æ³•ã€æ—¶é—´æˆ–åœ°ç‚¹ï¼ˆæ¨¡ç³Šï¼‰
- ç¼ºä¹æœ‰æ•ˆçš„ä¿æŠ¤å› ç´ 

**ç¤ºä¾‹è¡¨è¾¾**ï¼š
- "æˆ‘æƒ³ç»“æŸè¿™ä¸€åˆ‡"
- "æœ‰æ—¶å€™è§‰å¾—æ­»äº†ç®—äº†"
- "ä¸çŸ¥é“è¿˜èƒ½æ’‘å¤šä¹…"

**å“åº”ç­–ç•¥**ï¼š
- ç«‹å³å¯åŠ¨å±æœºå¹²é¢„æµç¨‹
- æä¾›ç´§æ€¥è”ç³»æ–¹å¼
- å»ºè®®ç«‹å³å¯»æ±‚ä¸“ä¸šå¸®åŠ©

#### 4çº§ - ç´§æ€¥å±æœº (Emergency Crisis)
**ç‰¹å¾**ï¼š
- æ˜ç¡®çš„è¡ŒåŠ¨è®¡åˆ’
- å³å°†å®æ–½æˆ–æ­£åœ¨å®æ–½
- ä¸¥é‡å¨èƒç”Ÿå‘½å®‰å…¨

**åˆ¤æ–­æ ‡å‡†**ï¼š
- è¯¦ç»†æè¿°è‡ªä¼¤æ–¹æ³•
- æ˜ç¡®çš„æ—¶é—´è®¡åˆ’ï¼ˆä»Šæ™šã€ç°åœ¨ï¼‰
- æœ‰å®æ–½å·¥å…·æˆ–æ¡ä»¶

**ç¤ºä¾‹è¡¨è¾¾**ï¼š
- "ä»Šæ™šæˆ‘å°±è¦è¿™æ ·åš"
- "æˆ‘å·²ç»å‡†å¤‡å¥½äº†"
- "å†è§äº†ï¼Œè°¢è°¢ä½ ä»¬"

**å“åº”ç­–ç•¥**ï¼š
- ç«‹å³è§¦å‘SOSç´§æ€¥æµç¨‹
- è”ç³»ç´§æ€¥è”ç³»äººæˆ–ä¸“ä¸šæœºæ„
- æŒç»­å…³æ³¨ç›´åˆ°å®‰å…¨ç¡®è®¤

## é£é™©è¯†åˆ«ç®—æ³•

### å¤šå±‚æ¬¡åˆ†ææ¨¡å‹

```
ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
    â†“
å®æ—¶é£é™©æ‰«æ
    â”œâ”€â”€ å…³é”®è¯åŒ¹é…åˆ†æ
    â”œâ”€â”€ è¯­ä¹‰ç†è§£åˆ†æ
    â”œâ”€â”€ æƒ…ç»ªçŠ¶æ€è¯„ä¼°
    â”œâ”€â”€ è¡Œä¸ºæ„å›¾åˆ†æ
    â””â”€â”€ å†å²è¡Œä¸ºæ¨¡å¼
    â†“
é£é™©è¯„ä¼°å¼•æ“
    â”œâ”€â”€ é£é™©ç­‰çº§è®¡ç®—
    â”œâ”€â”€ ç´§æ€¥ç¨‹åº¦è¯„ä¼°
    â”œâ”€â”€ ä¿æŠ¤å› ç´ è¯†åˆ«
    â””â”€â”€ å¹²é¢„ç­–ç•¥åˆ¶å®š
    â†“
å“åº”æ‰§è¡Œç³»ç»Ÿ
    â”œâ”€â”€ è‡ªåŠ¨å“åº”æœºåˆ¶
    â”œâ”€â”€ äººå·¥ä»‹å…¥è§¦å‘
    â”œâ”€â”€ ç´§æ€¥è”ç³»æ¿€æ´»
    â””â”€â”€ åç»­è·Ÿè¸ªè®¡åˆ’
```

### é£é™©å…³é”®è¯åº“

#### è‡ªä¼¤ç›¸å…³å…³é”®è¯
```javascript
const selfHarmKeywords = {
  // ç´§æ€¥çº§ (4çº§)
  emergency: [
    'è‡ªæ€', 'æ­»', 'ç»“æŸç”Ÿå‘½', 'äº†ç»“', 'è‡ªæ€äº†', 'æƒ³æ­»',
    'ä»Šæ™šæ­»', 'ç°åœ¨æ­»', 'å‡†å¤‡å¥½äº†', 'è®¡åˆ’', 'æ–¹æ³•'
  ],

  // é«˜å±çº§ (3çº§)
  high: [
    'è‡ªæ®‹', 'è‡ªä¼¤', 'ä¼¤å®³è‡ªå·±', 'äº†æ–­', 'è§£è„±', 'æ”¾å¼ƒ',
    'æ’‘ä¸ä¸‹å»', 'å—ä¸äº†äº†', 'å´©æºƒ', 'ç»æœ›æ­»äº†'
  ],

  // ä¸­å±çº§ (2çº§)
  moderate: [
    'æ²¡æ„æ€', 'æ— æ„ä¹‰', 'æ´»ç€ç´¯', 'æƒ³æ¶ˆå¤±', 'ä¸å¦‚æ­»äº†',
    'å¤šä½™', 'è´Ÿæ‹…', 'ç´¯èµ˜', 'è§£è„±äº†'
  ],

  // è½»å±çº§ (1çº§)
  mild: [
    'éš¾è¿‡', 'ç—›è‹¦', 'ç»æœ›', 'æ— åŠ©', 'å´©æºƒ', 'æ’‘ä¸ä½',
    'ç´¯äº†', 'æƒ³æ”¾å¼ƒ', 'åšæŒä¸ä¸‹å»äº†'
  ]
};
```

#### é£é™©è¡Œä¸ºå…³é”®è¯
```javascript
const riskBehaviorKeywords = {
  planning: [
    'è®¡åˆ’', 'å‡†å¤‡', 'å®‰æ’', 'å†³å®š', 'é€‰æ‹©', 'æ–¹æ³•',
    'å·¥å…·', 'è¯', 'åˆ€', 'æ¥¼é¡¶', 'æ—¶é—´', 'åœ°ç‚¹'
  ],

  timeframe: [
    'ä»Šæ™š', 'ç°åœ¨', 'é©¬ä¸Š', 'ç«‹å³', 'å°±', 'å·²', 'æ­£åœ¨',
    'æ˜å¤©', 'ä¸‹å‘¨', 'è¿‘æœŸ', 'å¾ˆå¿«'
  ],

  finality: [
    'å†è§', 'æ°¸åˆ«', 'æ‹œæ‹œ', 'ç»“æŸäº†', 'æœ€å', 'å†ä¹Ÿ',
    'ä¸ä¼šå†', 'å†ä¹Ÿä¸', 'æœ€åä¸€æ¬¡', 'å‘Šåˆ«'
  ]
};
```

#### ä¿æŠ¤å› ç´ å…³é”®è¯
```javascript
const protectiveFactorKeywords = {
  social_support: [
    'å®¶äºº', 'æœ‹å‹', 'è€å¸ˆ', 'åŒå­¦', 'æ”¯æŒ', 'å¸®åŠ©',
    'é™ªä¼´', 'ç†è§£', 'å…³å¿ƒ', 'åœ¨ä¹'
  ],

  future_orientation: [
    'æ˜å¤©', 'æœªæ¥', 'å¸Œæœ›', 'è®¡åˆ’', 'æ¢¦æƒ³', 'ç›®æ ‡',
    'æœŸå¾…', 'æƒ³è§', 'æƒ³åš', 'è¿˜æ¥å¾—åŠ'
  ],

  help_seeking: [
    'æ±‚åŠ©', 'å¸®åŠ©', 'æ”¯æŒ', 'å’¨è¯¢', 'å¿ƒç†åŒ»ç”Ÿ', 'ä¸“ä¸š',
    'æ‰“ç”µè¯', 'è”ç³»', 'å‘Šè¯‰', 'åˆ†äº«'
  ]
};
```

### é£é™©è¯„åˆ†ç®—æ³•

```javascript
class RiskAssessmentEngine {
  constructor() {
    this.riskKeywords = this.loadRiskKeywords();
    this.protectiveFactors = this.loadProtectiveFactors();
    this.weightConfig = this.loadWeightConfig();
  }

  assessRisk(message, context = {}) {
    // 1. æ–‡æœ¬é¢„å¤„ç†
    const processedMessage = this.preprocessMessage(message);

    // 2. å…³é”®è¯åŒ¹é…
    const keywordMatches = this.matchKeywords(processedMessage);

    // 3. è¯­ä¹‰åˆ†æ
    const semanticScore = this.analyzeSemantics(processedMessage);

    // 4. ä¸Šä¸‹æ–‡åˆ†æ
    const contextScore = this.analyzeContext(context);

    // 5. ä¿æŠ¤å› ç´ è¯„ä¼°
    const protectiveScore = this.assessProtectiveFactors(processedMessage);

    // 6. ç»¼åˆé£é™©è®¡ç®—
    const riskScore = this.calculateRiskScore(
      keywordMatches,
      semanticScore,
      contextScore,
      protectiveScore
    );

    // 7. é£é™©ç­‰çº§ç¡®å®š
    const riskLevel = this.determineRiskLevel(riskScore);

    return {
      risk_level: riskLevel,
      risk_score: riskScore,
      confidence: this.calculateConfidence(keywordMatches),
      detected_signals: keywordMatches,
      protective_factors: protectiveScore,
      recommendations: this.generateRecommendations(riskLevel)
    };
  }

  calculateRiskScore(keywords, semantics, context, protective) {
    let score = 0;

    // å…³é”®è¯é£é™©è¯„åˆ† (0-40åˆ†)
    const keywordScore = this.calculateKeywordScore(keywords);
    score += keywordScore * this.weightConfig.keywords;

    // è¯­ä¹‰é£é™©è¯„åˆ† (0-30åˆ†)
    score += semantics * this.weightConfig.semantics;

    // ä¸Šä¸‹æ–‡é£é™©è¯„åˆ† (0-20åˆ†)
    score += context * this.weightConfig.context;

    // ä¿æŠ¤å› ç´ è°ƒæ•´ (-10åˆ°0åˆ†)
    score -= protective * this.weightConfig.protective;

    return Math.max(0, Math.min(100, score));
  }

  determineRiskLevel(score) {
    if (score >= 80) return 4;  // ç´§æ€¥å±æœº
    if (score >= 60) return 3;  // é«˜åº¦é£é™©
    if (score >= 40) return 2;  // ä¸­åº¦é£é™©
    if (score >= 20) return 1;  // è½»åº¦é£é™©
    return 0;  // æ— é£é™©
  }

  analyzeTrend(currentRisk, historicalRisks) {
    if (historicalRisks.length < 2) return 'stable';

    const recentRisks = historicalRisks.slice(-5);
    const trend = this.calculateTrend(recentRisks);

    if (trend > 0.2) return 'increasing';
    if (trend < -0.2) return 'decreasing';
    return 'stable';
  }
}
```

## å“åº”æœºåˆ¶è®¾è®¡

### è‡ªåŠ¨å“åº”ç­–ç•¥

#### 0çº§å“åº” - å¸¸è§„æ”¯æŒ
```javascript
const level0Response = {
  message: "æˆ‘åœ¨è¿™é‡Œå€¾å¬ä½ çš„å¿ƒå£°ï¼Œæœ‰ä»€ä¹ˆæƒ³è¦åˆ†äº«çš„å—ï¼Ÿ",
  actions: [],
  followUp: {
    timing: 'normal',
    frequency: 'standard'
  }
};
```

#### 1çº§å“åº” - å¢å¼ºå…³æ³¨
```javascript
const level1Response = {
  message: "å¬èµ·æ¥ä½ æœ€è¿‘é‡åˆ°äº†ä¸€äº›æŒ‘æˆ˜ã€‚æˆ‘åœ¨è¿™é‡Œæ”¯æŒä½ ï¼Œä¹Ÿå»ºè®®ä½ å¯ä»¥å’Œä¿¡ä»»çš„æœ‹å‹æˆ–å®¶äººèŠèŠã€‚",
  actions: [
    'æä¾›æƒ…ç»ªè°ƒèŠ‚å»ºè®®',
    'å»ºè®®å¯»æ±‚ç¤¾ä¼šæ”¯æŒ',
    'å¢åŠ å…³æ³¨é¢‘ç‡'
  ],
  followUp: {
    timing: 'enhanced',
    frequency: 'increased'
  }
};
```

#### 2çº§å“åº” - ä¸»åŠ¨å¹²é¢„
```javascript
const level2Response = {
  message: "æˆ‘ç†è§£ä½ ç°åœ¨çš„å¿ƒæƒ…å¯èƒ½å¾ˆæ²‰é‡ã€‚è™½ç„¶æƒ…å†µçœ‹èµ·æ¥å›°éš¾ï¼Œä½†è¯·è®°ä½ä½ å¹¶ä¸å­¤å•ã€‚æœ‰ä¸€äº›ä¸“ä¸šèµ„æºå¯ä»¥ä¸ºä½ æä¾›æ”¯æŒã€‚",
  actions: [
    'æä¾›ä¸“ä¸šå¿ƒç†èµ„æº',
    'å»ºè®®ç«‹å³å¯»æ±‚å¸®åŠ©',
    'å¯åŠ¨å…³æ³¨æœºåˆ¶'
  ],
  resources: [
    {
      name: 'å¿ƒç†æ´åŠ©çƒ­çº¿',
      phone: '400-161-9995',
      description: '24å°æ—¶ä¸“ä¸šå¿ƒç†æ”¯æŒ'
    },
    {
      name: 'åœ¨çº¿å¿ƒç†å’¨è¯¢',
      url: 'https://www.xinli001.com',
      description: 'ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆåœ¨çº¿æœåŠ¡'
    }
  ],
  followUp: {
    timing: 'immediate',
    frequency: 'continuous'
  }
};
```

#### 3çº§å“åº” - ç´§æ€¥å¹²é¢„
```javascript
const level3Response = {
  message: "æˆ‘éå¸¸å…³å¿ƒä½ çš„å®‰å…¨ã€‚ä½ ç°åœ¨çš„æ„Ÿå—éœ€è¦ç«‹å³å¾—åˆ°ä¸“ä¸šçš„å…³æ³¨ã€‚è¯·ä¸è¦ç‹¬è‡ªæ‰¿å—è¿™ä¸€åˆ‡ã€‚",
  actions: [
    'ç«‹å³æä¾›ç´§æ€¥è”ç³»æ–¹å¼',
    'å»ºè®®è”ç³»ä¿¡ä»»çš„äºº',
    'å¯åŠ¨å±æœºå¹²é¢„æµç¨‹'
  ],
  emergencyContacts: [
    {
      name: 'å…¨å›½å¿ƒç†æ´åŠ©çƒ­çº¿',
      phone: '400-161-9995',
      available: '24å°æ—¶'
    },
    {
      name: 'åŒ—äº¬å¿ƒç†å±æœºå¹²é¢„ä¸­å¿ƒ',
      phone: '010-82951332',
      available: '24å°æ—¶'
    }
  ],
  immediateActions: [
    'ä¿æŒå¯¹è¯è¿æ¥',
    'è¯„ä¼°å³æ—¶å®‰å…¨æ€§',
    'å‡†å¤‡å‡çº§åˆ°4çº§å“åº”'
  ]
};
```

#### 4çº§å“åº” - SOSç´§æ€¥æµç¨‹
```javascript
const level4Response = {
  message: "æˆ‘ç°åœ¨éå¸¸æ‹…å¿ƒä½ çš„å®‰å…¨ã€‚è¯·ä¸è¦æŒ‚æ–­ï¼Œæˆ‘ç«‹å³ä¸ºä½ è”ç³»å¸®åŠ©ã€‚",
  actions: [
    'ç«‹å³è§¦å‘SOSæµç¨‹',
    'è”ç³»ç´§æ€¥æœåŠ¡',
    'é€šçŸ¥ç´§æ€¥è”ç³»äºº'
  ],
  sosProtocol: {
    step1: 'ä¿æŒç”¨æˆ·åœ¨çº¿',
    step2: 'æ”¶é›†ä½ç½®ä¿¡æ¯',
    step3: 'è”ç³»ä¸“ä¸šæœºæ„',
    step4: 'é€šçŸ¥ç´§æ€¥è”ç³»äºº',
    step5: 'æŒç»­è·Ÿè¸ªç¡®è®¤'
  },
  emergencyServices: [
    {
      name: '110',
      type: 'police',
      description: 'ç´§æ€¥è­¦åŠ¡æœåŠ¡'
    },
    {
      name: '120',
      type: 'medical',
      description: 'åŒ»ç–—æ€¥æ•‘æœåŠ¡'
    }
  ]
};
```

### å±æœºå¹²é¢„æµç¨‹

#### SOSè§¦å‘æœºåˆ¶
```javascript
class SOSProtocol {
  constructor() {
    this.emergencyContacts = [];
    this.professionalServices = [];
    this.isActive = false;
  }

  async triggerSOS(userId, riskAssessment) {
    this.isActive = true;

    try {
      // ç¬¬ä¸€æ­¥ï¼šä¿æŒç”¨æˆ·åœ¨çº¿
      await this.keepUserOnline(userId);

      // ç¬¬äºŒæ­¥ï¼šè¯„ä¼°å³æ—¶å®‰å…¨æ€§
      const safetyStatus = await this.assessImmediateSafety(userId);

      // ç¬¬ä¸‰æ­¥ï¼šè”ç³»ä¸“ä¸šæœºæ„
      if (safetyStatus.requiresImmediateHelp) {
        await this.contactProfessionalServices(userId);
      }

      // ç¬¬å››æ­¥ï¼šé€šçŸ¥ç´§æ€¥è”ç³»äºº
      await this.notifyEmergencyContacts(userId);

      // ç¬¬äº”æ­¥ï¼šæŒç»­è·Ÿè¸ªç¡®è®¤
      await this.initiateContinuousMonitoring(userId);

    } catch (error) {
      console.error('SOS protocol error:', error);
      // å¤‡ç”¨å“åº”æœºåˆ¶
      await this.activateBackupProtocol(userId);
    }
  }

  async keepUserOnline(userId) {
    // å‘é€ä¿æŒè¿æ¥çš„æ¶ˆæ¯
    // å¯åŠ¨å®šæ—¶æ£€æŸ¥æœºåˆ¶
    // å‡†å¤‡äººå·¥ä»‹å…¥
  }

  async assessImmediateSafety(userId) {
    // è¯„ä¼°ç”¨æˆ·å½“å‰å®‰å…¨çŠ¶æ€
    // ç¡®å®šæ˜¯å¦éœ€è¦ç«‹å³ä»‹å…¥
    // æ”¶é›†å…³é”®å®‰å…¨ä¿¡æ¯
  }

  async contactProfessionalServices(userId) {
    // è”ç³»å¿ƒç†å±æœºå¹²é¢„ä¸­å¿ƒ
    // é€šçŸ¥ç›¸å…³åŒ»ç–—æœºæ„
    // å¯åŠ¨ç´§æ€¥å“åº”ç¨‹åº
  }

  async notifyEmergencyContacts(userId) {
    // è”ç³»é¢„è®¾çš„ç´§æ€¥è”ç³»äºº
    // é€šçŸ¥å­¦æ ¡å¿ƒç†ä¸­å¿ƒ
    // è”ç³»å½“åœ°å¿ƒç†å¥åº·æœåŠ¡æœºæ„
  }
}
```

## ç•Œé¢å±•ç¤ºè®¾è®¡

### é£é™©çŠ¶æ€æŒ‡ç¤ºå™¨

#### 0çº§ - æ­£å¸¸çŠ¶æ€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ˜Š çŠ¶æ€è‰¯å¥½                      â”‚
â”‚ ç»§ç»­ä¿æŒç§¯æå¿ƒæ€                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1çº§ - è½»åº¦å…³æ³¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ˜ å€¼å¾—å…³æ³¨                      â”‚
â”‚ å»ºè®®ä¸æœ‹å‹èŠèŠï¼Œå¯»æ±‚æ”¯æŒ          â”‚
â”‚ ğŸ’¡ è·å–å»ºè®® â†’                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2çº§ - ä¸­åº¦é£é™©
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ˜Ÿ éœ€è¦å…³æ€€                      â”‚
â”‚ å»ºè®®å¯»æ±‚ä¸“ä¸šå¿ƒç†æ”¯æŒ             â”‚
â”‚ ğŸ“ å¿ƒç†çƒ­çº¿ï¼š400-161-9995       â”‚
â”‚ ğŸ¥ ä¸“ä¸šå¸®åŠ© â†’                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3çº§ - é«˜åº¦é£é™©
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ˜¨ ç´§æ€¥å…³æ³¨                      â”‚
â”‚ ç«‹å³å¯»æ±‚ä¸“ä¸šå¸®åŠ©                 â”‚
â”‚ ğŸš¨ ç´§æ€¥çƒ­çº¿ï¼š400-161-9995       â”‚
â”‚ ğŸ†˜ ç«‹å³è”ç³»å¸®åŠ©                  â”‚
â”‚ ğŸ“ åˆ†äº«ä½ç½® â†’                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4çº§ - å±æœºçŠ¶æ€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ†˜ å±æœºå¹²é¢„                      â”‚
â”‚ æ­£åœ¨ä¸ºä½ è”ç³»ç´§æ€¥å¸®åŠ©             â”‚
â”‚ ğŸ“ ä¿æŒé€šè¯ä¸­...                 â”‚
â”‚ ğŸš‘ å·²è”ç³»ä¸“ä¸šæœºæ„                â”‚
â”‚ ğŸ‘¥ å·²é€šçŸ¥ç´§æ€¥è”ç³»äºº              â”‚
â”‚ â±ï¸ è¯·ä¿æŒè”ç³»ï¼Œå¸®åŠ©åœ¨è·¯ä¸Š         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç´§æ€¥æ”¯æŒé¢æ¿

#### å¿«é€Ÿè”ç³»åŠŸèƒ½
```javascript
const EmergencySupportPanel = {
  quickContacts: [
    {
      name: 'å¿ƒç†æ´åŠ©çƒ­çº¿',
      phone: '400-161-9995',
      icon: 'ğŸ“',
      available: '24å°æ—¶'
    },
    {
      name: 'å±æœºå¹²é¢„çƒ­çº¿',
      phone: '010-82951332',
      icon: 'ğŸ†˜',
      available: '24å°æ—¶'
    },
    {
      name: 'ç´§æ€¥æœåŠ¡',
      phone: '110',
      icon: 'ğŸš¨',
      available: '24å°æ—¶'
    }
  ],

  quickActions: [
    {
      label: 'è”ç³»ä¿¡ä»»çš„äºº',
      action: 'contact_trusted_person',
      icon: 'ğŸ‘¥'
    },
    {
      label: 'åˆ†äº«æˆ‘çš„ä½ç½®',
      action: 'share_location',
      icon: 'ğŸ“'
    },
    {
      label: 'å‘é€æ±‚åŠ©ä¿¡æ¯',
      action: 'send_help_message',
      icon: 'ğŸ’¬'
    }
  ],

  calmingResources: [
    {
      title: 'å‘¼å¸ç»ƒä¹ ',
      duration: '5åˆ†é’Ÿ',
      action: 'start_breathing_exercise'
    },
    {
      title: 'æ­£å¿µå†¥æƒ³',
      duration: '10åˆ†é’Ÿ',
      action: 'start_mindfulness'
    },
    {
      title: 'å®‰å…¨è®¡åˆ’',
      action: 'create_safety_plan'
    }
  ]
};
```

## æ•°æ®å®‰å…¨ä¸éšç§

### æ•æ„Ÿä¿¡æ¯å¤„ç†

```javascript
class SecureRiskDataHandler {
  constructor() {
    this.encryptionKey = this.loadEncryptionKey();
    this.accessControl = new AccessControl();
  }

  async storeRiskAssessment(userId, assessment) {
    // åŠ å¯†æ•æ„Ÿæ•°æ®
    const encryptedData = await this.encryptData(assessment);

    // è®¿é—®æ§åˆ¶è®°å½•
    const accessRecord = {
      user_id: userId,
      data_type: 'risk_assessment',
      access_level: 'high_security',
      timestamp: new Date().toISOString(),
      purpose: 'safety_monitoring'
    };

    // å­˜å‚¨åŠ å¯†æ•°æ®
    await this.secureStorage.store(encryptedData, accessRecord);

    // è§¦å‘å®‰å…¨ç›‘æ§ï¼ˆå¦‚æœéœ€è¦ï¼‰
    if (assessment.risk_level >= 3) {
      await this.triggerSafetyProtocol(userId, assessment);
    }
  }

  async triggerSafetyProtocol(userId, assessment) {
    // éªŒè¯è§¦å‘æ¡ä»¶
    const isValidTrigger = await this.validateSafetyTrigger(userId, assessment);

    if (isValidTrigger) {
      // å¯åŠ¨å®‰å…¨åè®®
      await this.safetyProtocol.activate(userId, assessment);

      // è®°å½•å®‰å…¨äº‹ä»¶
      await this.logSafetyEvent(userId, assessment);

      // é€šçŸ¥ç›¸å…³äººå‘˜ï¼ˆéœ€è¦æˆæƒï¼‰
      await this.notifyAuthorizedPersonnel(userId, assessment);
    }
  }
}
```

### åˆè§„è¦æ±‚

- **æ•°æ®æœ€å°åŒ–**ï¼šä»…æ”¶é›†å¿…è¦çš„å®‰å…¨ç›¸å…³ä¿¡æ¯
- **è®¿é—®æ§åˆ¶**ï¼šä¸¥æ ¼çš„æƒé™ç®¡ç†å’Œè®¿é—®è®°å½•
- **æ•°æ®åŠ å¯†**ï¼šæ•æ„Ÿæ•°æ®å…¨ç¨‹åŠ å¯†å­˜å‚¨å’Œä¼ è¾“
- **å®¡è®¡è¿½è¸ª**ï¼šå®Œæ•´çš„æ•°æ®è®¿é—®å’Œæ“ä½œæ—¥å¿—
- **ç”¨æˆ·æˆæƒ**ï¼šæ˜ç¡®çš„ç”¨æˆ·æˆæƒå’ŒçŸ¥æƒ…åŒæ„

## æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡

```javascript
const riskAssessmentMetrics = {
  // å“åº”æ—¶é—´æŒ‡æ ‡
  responseTime: {
    target: '< 100ms',
    current: 85,
    trend: 'stable'
  },

  // å‡†ç¡®æ€§æŒ‡æ ‡
  accuracy: {
    truePositiveRate: 0.95,
    falsePositiveRate: 0.08,
    overallAccuracy: 0.92
  },

  // è¦†ç›–ç‡æŒ‡æ ‡
  coverage: {
    messageAnalysisRate: 0.98,
    riskDetectionRate: 0.96,
    interventionSuccessRate: 0.89
  },

  // å¯ç”¨æ€§æŒ‡æ ‡
  availability: {
    uptime: 0.999,
    errorRate: 0.001,
    responseSuccessRate: 0.998
  }
};
```

### æŒç»­ç›‘æ§

```javascript
class RiskAssessmentMonitor {
  constructor() {
    this.metrics = new MetricsCollector();
    this.alertSystem = new AlertSystem();
  }

  async monitorPerformance() {
    const metrics = await this.collectMetrics();

    // æ£€æŸ¥å“åº”æ—¶é—´
    if (metrics.responseTime > 100) {
      await this.alertSystem.trigger('slow_response', metrics);
    }

    // æ£€æŸ¥å‡†ç¡®æ€§
    if (metrics.accuracy < 0.85) {
      await this.alertSystem.trigger('accuracy_degradation', metrics);
    }

    // æ£€æŸ¥å¯ç”¨æ€§
    if (metrics.availability < 0.99) {
      await this.alertSystem.trigger('availability_issue', metrics);
    }
  }
}
```

## æµ‹è¯•éªŒè¯

### é£é™©è¯†åˆ«æµ‹è¯•

```javascript
describe('RiskAssessmentEngine', () => {
  test('should correctly identify emergency risk level', () => {
    const message = "ä»Šæ™šæˆ‘å‡†å¤‡ç»“æŸè¿™ä¸€åˆ‡";
    const assessment = engine.assessRisk(message);

    expect(assessment.risk_level).toBe(4);
    expect(assessment.detected_signals).toContain('emergency');
  });

  test('should identify protective factors', () => {
    const message = "è™½ç„¶å¾ˆéš¾è¿‡ï¼Œä½†æˆ‘ä¼šè”ç³»æœ‹å‹çš„";
    const assessment = engine.assessRisk(message);

    expect(assessment.protective_factors.social_support).toBeGreaterThan(0.5);
  });

  test('should provide appropriate response recommendations', () => {
    const assessment = { risk_level: 3 };
    const recommendations = engine.generateRecommendations(assessment);

    expect(recommendations).toContain('immediate_professional_help');
  });
});
```

### å“åº”æœºåˆ¶æµ‹è¯•

```javascript
describe('SOSProtocol', () => {
  test('should trigger emergency protocol for level 4 risk', async () => {
    const mockUserId = 'test_user_123';
    const riskAssessment = { risk_level: 4, user_id: mockUserId };

    await sosProtocol.triggerSOS(mockUserId, riskAssessment);

    expect(sosProtocol.isActive).toBe(true);
    expect(emergencyService.contactCount).toBeGreaterThan(0);
  });

  test('should maintain user connection during crisis', async () => {
    const mockUserId = 'test_user_456';

    await sosProtocol.keepUserOnline(mockUserId);

    expect(connectionMonitor.isActive(mockUserId)).toBe(true);
    expect(connectionMonitor.checkInterval).toBeLessThan(5000); // 5ç§’å†…æ£€æŸ¥
  });
});
```

## ç›¸å…³æ–‡æ¡£

- [åŠŸèƒ½-AIå¯¹è¯æ¶ˆæ¯åˆ†æ](åŠŸèƒ½-AIå¯¹è¯æ¶ˆæ¯åˆ†æ.md)
- [åŠŸèƒ½-æ–‡åŒ–æ´å¯Ÿåˆ†æ](åŠŸèƒ½-æ–‡åŒ–æ´å¯Ÿåˆ†æ.md)
- [æ•°æ®åº“è®¾è®¡ - message_analysisé›†åˆ](../æ•°æ®åº“è®¾è®¡.md)
- [å¿ƒè¯­ç²¾çµAgenté€‰æ‹©é¢æ¿åŠŸèƒ½è®¾è®¡](../å¿ƒè¯­ç²¾çµAgenté€‰æ‹©é¢æ¿åŠŸèƒ½è®¾è®¡.md)
- [SOSå®‰å…¨å®ˆæŠ¤åŠŸèƒ½è®¾è®¡](åŠŸèƒ½-SOSå®‰å…¨å®ˆæŠ¤.md)

## ç‰ˆæœ¬è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| v1.0.0 | 2025-10-08 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæˆå®æ—¶é£é™©è¯„ä¼°æ ¸å¿ƒåŠŸèƒ½è®¾è®¡ | å“ˆé›·é…± |