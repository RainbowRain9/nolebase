# 测试用例

依据功能文档拆解首批功能测试场景，表格统一采用“输入 → 操作步骤 → 预期结果”的结构，后续可在联调阶段补充边界与异常流程。

## 今天 Tab

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| TODAY-001 | 多次情绪打卡累计曲线 | 账号存在 1 条历史打卡；今日未打卡 | 1. 进入今天页<br>2. 点击“再次打卡”录入情绪评分/标签/场景<br>3. 再次点击“再次打卡”录入第二条记录 | 心情曲线出现 2 个时间点；状态卡展示最新情绪；`checkins` 写入 2 条记录并携带标签与风险等级 |
| TODAY-002 | 负向情绪触发 ASK 联动 | 风险策略判定为 R2；账号已开通 ASK | 1. 进行情绪打卡选择负向情绪并提交<br>2. 观察浮层并点击“开始对话”<br>3. 输入问题并选择推荐行动 | ASK 浮层自动展开；会话记录入 `ask_sessions`；点击行动写入任务清单并来源标记“ASK-AI” |
| TODAY-003 | 微建议写入任务清单 | 微建议服务返回 3 条建议；清单为空 | 1. 在 Top 微建议区点击“一键加入清单”<br>2. 在弹窗中确认来源与计划时间 | Toast 提示写入成功；任务列表新增记录并显示来源“AI 建议”；页面提示可在任务 Tab 查看 |
| TODAY-004 | 任务复盘回写成长统计 | 任务列表存在 1 条进行中任务 | 1. 点击任务卡“完成”<br>2. 在复盘表单填写情绪前后评分并提交 | 任务状态更新为完成；生成 `task_reviews` 记录；成长统计与周报数据同步更新 |

## 心情随笔 Tab

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| JOUR-001 | 多模随笔录入（语音+图片） | 设备语音/相册权限已授权 | 1. 点击“新增随笔”<br>2. 录制语音并自动转写<br>3. 上传手写照片并确认 OCR 结果<br>4. 补充文本与情绪评分后保存 | 随笔列表新增记录并标注“语音+图片”；`journals` 存储转写文本、OCR 内容与情绪标签；若当日未打卡则同步生成情绪打卡 |
| JOUR-002 | AI 摘要筛选关键词 | 账号存在 ≥7 条随笔及情绪打卡 | 1. 查看 AI 摘要卡<br>2. 切换“周 → 月”粒度<br>3. 点击关键词 Chip“室友关系” | 折线图与词云根据粒度更新；列表仅展示包含关键词的随笔；筛选提示展示在列表顶部 |
| JOUR-003 | 随笔派生任务 | 至少存在 1 条随笔 | 1. 打开随笔卡<br>2. 点击“生成任务”<br>3. 选择来源“自建任务”并确认 | 新任务写入清单并回链对应随笔；提示“查看任务 Tab”链接；任务卡显示来源“自建” |
| JOUR-004 | 负向随笔预警与 ASK | 连续 1 条随笔情绪为“焦虑” | 1. 新增随笔设置情绪为“沮丧”并保存 | 系统检测到连续负向情绪，弹出 ASK 提示条与资源按钮；操作记录入 `risk_events` |

## 任务 Tab

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| TASK-001 | 多来源任务看板展示 | 任务库含 AI/树洞/真人/自建任务各 1 条 | 1. 打开任务 Tab<br>2. 查看任务列表和来源徽章 | 列表展示所有任务，每张卡片左上角清晰显示来源标签（AI建议/树洞/真人/自建）；任务按状态自动分组显示 |
| TASK-002 | 分类与筛选功能 | 存在多条不同情绪类别的任务 | 1. 打开任务 Tab<br>2. 点击顶部分类筛选器<br>3. 选择"学业"类别和"AI建议"来源 | 列表仅展示学业相关的AI建议任务；筛选状态清晰显示；支持一键清除筛选条件 |
| TASK-003 | 状态自动分组 | 存在进行中/已完成/延期状态的任务 | 1. 打开任务 Tab<br>2. 滚动查看任务列表 | 任务按"进行中"、"已完成"、"延期"等状态自动分组显示；每组任务数量明确标注 |
| TASK-004 | 执行与复盘闭环 | 任意任务状态为进行中 | 1. 点击任务卡"开始"执行任务<br>2. 完成任务操作<br>3. 填写复盘表单记录情绪变化 | 任务状态更新为完成；系统自动弹出复盘表单；记录情绪前后变化和执行感受；形成完整闭环 |
| TASK-005 | 数据洞察抽屉 | 存在完成任务的历史数据 | 1. 打开任务 Tab<br>2. 向上拖拽页面底部抽屉 | 抽屉展示各类任务完成度曲线；显示任务延迟原因分析；提供执行力洞察数据 |
| TASK-006 | 番茄计时与任务管理 | 任意任务状态为进行中 | 1. 点击任务卡"开始"进入番茄计时<br>2. 计时完成后填写复盘表单 | 番茄计时器正常运行；计时结束自动触发复盘；任务状态和相关数据正确更新 |
| TASK-007 | 批量操作功能 | 列表存在多条任务 | 1. 进入批量模式选择多个任务<br>2. 执行批量操作 | 支持批量延期、设置提醒等操作；操作结果正确反馈；相关日志记录完整 |
| TASK-008 | 真人任务指派与回执 | 有辅导员指派的待确认任务 | 1. 打开真人任务详情<br>2. 确认接受并执行任务<br>3. 提交回执 | 任务状态正确更新；辅导员收到通知；回执信息完整记录 |
| TASK-009 | 任务关联链接跳转 | 存在来源于随笔或树洞的任务 | 1. 点击任务卡的来源链接<br>2. 查看关联内容 | 正确跳转到对应的随笔或树洞页面；显示完整的关联上下文信息 |
| TASK-010 | 任务提醒与通知 | 设置了提醒时间的任务 | 到达提醒时间时 | 系统发送任务提醒通知；用户可以点击通知快速跳转到任务详情 |

## 树洞 Tab

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| HOLE-001 | 发帖自检与风险分级 | 用户实名已通过；内容包含情绪词“累” | 1. 点击“发帖”并填写内容<br>2. 进入草稿自检勾选守则与匿名<br>3. 发布帖子 | 帖子发布成功并展示风险等级（如 L1）；自检结果写入日志；`posts` 记录风险分级与提示语 |
| HOLE-002 | 行动卡领取写入任务清单 | 信息流存在行动卡贴；清单容量未达上限 | 1. 点击行动卡“领取任务”<br>2. 在确认弹窗选择“通知辅导员” | 任务写入清单并源标“树洞”；生成真人待确认任务；提示跳转任务 Tab 查看 |
| HOLE-003 | 高风险帖子资源触达 | 某帖子被标记 L3；资源地图已配置 | 1. 打开带红色提示条帖子<br>2. 点击“查看资源”并选择“联系心理中心” | 跳转资源地图详情并显示联系方式；后台 `risk_alerts` 记录处置动作；若确认联系则生成触达日志 |
| HOLE-004 | 评论触发再次预警 | 帖子为 L2；用户输入包含关键词“想放弃” | 1. 在帖子详情输入评论“最近想放弃努力”<br>2. 点击发送 | 系统拦截并提示风险；允许用户修改或请求 AI/真人帮助；`risk_actions` 记录用户选择 |

## 我的 Tab

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| MINE-001 | 查看护心周报并生成任务 | 最新周报已生成；网络正常 | 1. 打开我的 Tab<br>2. 点击护心周报卡“查看完整周报”<br>3. 在建议列表点击“生成任务” | 跳转周报详情；展示情绪趋势、任务完成率（按来源和情绪类别）；生成的任务写入清单并来源标记“周报建议” |
| MINE-002 | 成长统计来源切换 | 清单存在多来源任务及复盘数据 | 1. 滚动至成长统计面板<br>2. 切换“AI 建议/树洞领取/真人指派/自建”分类 | 进度条与数量随分类更新；点击任意分类跳转至任务 Tab 对应筛选结果 |
| MINE-003 | 管理真人授权 | 已向辅导员授权数据访问 | 1. 打开隐私与授权中心<br>2. 点击“辅导员”授权项并选择“撤销授权”<br>3. 确认操作 | 授权状态更新为未授权；`audit_logs` 记录变更；辅导员端收到授权撤销通知 |
| MINE-004 | 资源触达记录 | 资源地图配置“心理中心”热线 | 1. 在资源地图区块点击“心理中心”卡片<br>2. 选择“匿名联系” | 调起电话拨号器并自动填入号码；回到页面后卡片标记“已联系”；`resource_touches` 记录触达结果 |

## 全局

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| GLOBAL-001 | 快速记一笔语音转随笔 | 语音权限已开启；网络正常 | 1. 点击悬浮按钮<br>2. 选择语音记录并录制 10 秒<br>3. 确认生成随笔 | 语音成功转文本并写入 `journals`；心情随笔列表刷新；如当日无打卡则同步生成情绪打卡 |
| GLOBAL-002 | Ask 心理助理行动同步 | 账号已登录；网络正常 | 1. 轻点 ASK 浮标打开对话<br>2. 输入“考前焦虑怎么办”<br>3. 点击推荐行动卡“深呼吸练习” | AI 返回建议文本；行动卡写入任务清单并来源标记“ASK-AI”；提示前往任务 Tab 查看 |
| GLOBAL-003 | 晚安模式提醒 | 当前时间 22:30；开启晚安模式 22:00-07:00 | 1. 在任务 Tab 点击任务“开始” | 系统弹出低扰提示并切换夜间主题；仍允许执行任务；记录夜间操作日志 |
| GLOBAL-004 | 登录态失效处理 | 模拟 token 过期；接口返回 401 | 1. 在任何页面下拉刷新 | 弹出登录失效提示；点击后跳转登录页；刷新前页面保留草稿内容 |

## 社区分包（新增用例占位）

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| HOLE-TOPIC-001 | 话题聚合筛选与订阅 | 占位 | 占位 | 占位 |
| AF-001 | 行动卡反馈提交回执 | 占位 | 占位 | 占位 |
| ACT-001 | 活动广场报名流程 | 占位 | 占位 | 占位 |
| BOOK-001 | 预约中心提交与冲突检测 | 占位 | 占位 | 占位 |
| CONS-001 | 心理咨询详情与拨号/地图 | 占位 | 占位 | 占位 |
| CS-001 | 客服与帮助（FAQ 搜索与客服唤起） | 占位 | 占位 | 占位 |
| MSG-001 | 消息中心分组与已读 | 占位 | 占位 | 占位 |
| SRCH-001 | 搜索历史/联想/结果跳转 | 占位 | 占位 | 占位 |
| ACD-001 | 学术资源筛选/收藏 | 占位 | 占位 | 占位 |

## 日记域分包（新增用例占位）

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| REP-EXP-001 | 周报导出与分享 | 占位 | 占位 | 占位 |

## 我的 Tab（新增用例占位）

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| BADGE-001 | 徽章详情与分享 | 占位 | 占位 | 占位 |
| PROF-EDIT-001 | 资料编辑与头像上传 | 占位 | 占位 | 占位 |
| FEED-001 | 问题反馈提交与进度 | 占位 | 占位 | 占位 |

## 学校协同/审核（新增用例占位）

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| SCH-COOP-001 | 风控闭环（开始/误报/升级/关闭） | 占位 | 占位 | 占位 |
| AUDIT-001 | 审核中心决策与审计日志 | 占位 | 占位 | 占位 |

## 全局（新增用例占位）

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| SOS-001 | SOS 触发/取消/资源联动 | 占位 | 占位 | 占位 |
| SOS-SW-001 | SOS 资源切换与可用性记录 | 占位 | 占位 | 占位 |

## 工具分包（新增用例占位）

| 用例编号 | 场景 | 输入 | 操作步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| BR-001 | 呼吸练习完成与回执 | 占位 | 占位 | 占位 |
| MF-001 | 正念练习完成与回执 | 占位 | 占位 | 占位 |
