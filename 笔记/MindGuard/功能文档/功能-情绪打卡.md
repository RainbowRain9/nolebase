# 功能：情绪打卡与心情曲线

## 功能简介
围绕“今天”页的情绪状态卡，支持同日多次打卡，记录情绪评分、标签、场景与备注；自动绘制当日心情曲线，并为 AI 情感计算、微建议和周报提供基础数据。负向情绪会触发 ASK 助理、任务推荐及预警策略。

## 所在页面
- Tab：今天
- 模块：顶部情绪状态卡、情绪曲线抽屉
- 快捷入口：心情随笔页保存随笔时可补打卡

## 交互说明
1. 用户点击状态卡或“再次打卡”按钮，弹出情绪打卡面板。
2. 面板提供情绪评分（五档表情刻度）、情绪标签（支持自定义/多选）、场景标签（学业/社交/自我等）及自由备注。
3. 点击“保存”后，系统记录打卡时间、评分与标签，刷新当日曲线节点；若当天已有数据，新点会以时间顺序插入并重绘曲线。
4. AI 即刻判定情绪类型（正向/中性/负向）及风险等级（L1-L3），在状态卡上更新彩色徽标和提示文案。
5. 若情绪为负向或风险≥L2，自动展开 ASK 助理浮层并推送 2-3 条微建议；用户可选择立即对话、生成任务或忽略。
6. 打卡成功后可选择“补充随笔”，跳转到心情随笔录入面板并携带当前数据；也可直接关闭回到首页。

## 界面组件
- 情绪打卡弹窗：表情刻度控件、标签多选器、备注输入框。
- 打卡历史列表：按时间倒序展示当日所有打卡记录，支持展开备注。
- 心情曲线：折线图展示当日情绪波动，点击任一点可查看详细记录。
- 风险提示徽标：根据 L1-L3 切换绿色/橙色/红色徽标，附提示文案。
- “补充随笔”按钮：位于提交成功状态页，跳转心情随笔。

## 数据需求
- `checkins` 表：`user_id`、`mood_score`、`mood_category`、`mood_tags[]`、`scene_tags[]`、`notes`、`risk_level`、`created_at`。
- `mood_daily_curve`：按日聚合曲线节点，供状态卡与周报使用。
- 风险联动：打卡记录推送至情绪分析服务，回写 `risk_level` 与推荐任务 ID。
- 关联模块：成功打卡后调用微建议接口，并根据风险触发 ASK 助理/真人通知。
