# 功能：清单任务管理

## 功能简介
清单任务管理承载用户所有行动任务，包括 AI 微建议、树洞领取、心理咨询师/辅导员指派及用户自建任务。系统按照来源与情绪类别进行分组展示，提供状态管理、番茄计时、复盘记录，并将执行结果同步至成长反馈与周报。

## 所在页面
- 任务 Tab：主视图与统计抽屉
- 今天 Tab：任务执行区、Top 微建议入口
- 心情随笔 Tab：随笔派生任务入口
- 树洞 Tab：行动卡领取成功提示
- 我的 Tab：成长统计与周报

## 交互说明
1. 任务来源：所有任务写入统一清单，并在卡片左上角显示来源标签（AI / 树洞 / 真人 / 自建）。
2. 列表视图：任务 Tab 默认展示“进行中”任务，顶部提供来源筛选（全部/AI/社区/真人/自建）、情绪类别标签与状态筛选（进行中/即将到期/延期/已完成/已跳过）。
3. 任务详情：点击任务进入详情面板，包含任务说明、预估时长、提醒设置、番茄计时器入口、来源信息及关联随笔/树洞。
4. 执行流程：  
   - 开始任务：可开启番茄计时；计时完成后弹出复盘表单。  
   - 暂停/跳过：须选择原因（心情波动、时间冲突等），用于统计。  
   - 完成任务：填写复盘摘要，选择情绪变化，必要时上传附件或语音反馈。  
5. 真人任务：当任务来源为心理咨询师/辅导员时，完成后需“提交回执”，后台可查看反馈并给出评价；未按时完成会进入协同待办列表。
6. 数据抽屉：向上拖拽底部把手可查看来源/情绪类别完成度曲线、延迟原因 Top5、真人协同待确认任务。
7. 同步策略：任务状态变更后同步至今天 Tab、心情随笔随笔卡和我的 Tab，更新任务执行统计与周报数据。

## 状态与分类体系
- 状态：进行中、已完成、延期、跳过、待确认（真人指派未确认）、待复盘（计时完成未填写）。
- 来源：`AI_RECO`、`TREEHOLE`、`COUNSELOR`、`MENTOR`、`SELF`。
- 情绪类别：社交、人际、学业、自我、健康、其他（从情绪标签映射）。
- 统计项：完成率、延期率、平均复盘情绪得分、来源贡献度。

## 数据需求
- `tasks`：`task_id`、`user_id`、`source`、`emotion_category`、`title`、`description`、`estimated_minutes`、`planned_at`、`due_at`、`created_at`。
- `task_status_logs`：`task_id`、`status`、`reason`、`changed_at`。
- `task_reviews`：`task_id`、`mood_before`、`mood_after`、`review_notes`、`attachments[]`、`needs_human_followup`。
- `task_assignments`：记录真人指派信息（指派方、审核状态、反馈链接）。
- `task_tags`：关联关键词、场景标签，便于检索与统计。
