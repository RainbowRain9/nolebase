# 功能：资源推送系统

## 功能简介
基于用户情绪状态、行为数据和风险等级，智能推送个性化的心理资源，包括解压视频、放松音乐、心理文章、自助工具等，实现精准的心理健康支持。

## 所在页面
- **资源推送中心**：主要功能页面，集中展示个性化推荐、分类资源库、推送设置和效果反馈
- 今天 Tab：情绪打卡后的智能推荐入口
- 树洞 Tab：风险预警时的资源推送
- 心情随笔 Tab：连续负向情绪的关怀推送
- 我的 Tab：定期健康推送和收藏管理
- 全局：基于用户行为的个性化推送通知

## 交互说明

### 1. 情绪打卡后推送
用户完成情绪打卡后，系统根据情绪状态立即推送相关资源：
- **焦虑状态**：推送时间管理、放松技巧、正念练习资源
- **抑郁状态**：推送活力唤醒、社交活动、成就感建立资源
- **愤怒状态**：推送情绪调节、冲突处理、压力释放资源
- **开心状态**：推送情绪维持、感恩练习、分享表达资源

### 2. 风险预警时推送
当系统检测到风险信号时，主动推送针对性资源：

#### 中风险场景 (L2/R3级) 资源推送
- **触发条件**：系统判定用户处于中等风险状态
- **推送形式**：在"树洞"帖子或"今天"页面顶部显示**橙色提示条**
- **推送内容**：
  - "查看资源"选项：引导至资源地图页面
  - "联系辅导员"选项：提供校内心理支持渠道
  - 结构化自助工具包：针对中等风险的心理调适工具
- **资源整合**：包含校内心理中心、辅导员联系方式、社团活动和外部公益热线等多种求助渠道

#### 高风险场景 (L3/R4级) 资源推送
- **触发条件**：风险升级为高度状态
- **推送形式**：通过**红色高亮的安全提示条**强制展示
- **推送内容**：
  - SOS紧急支持入口：一键触发紧急求助流程
  - 校园心理咨询入口：直接连接专业心理服务
  - 强制性资源引导：确保用户以最短路径获得专业帮助
- **强制性机制**：用户无法忽略提示，必须选择相应操作

#### 低风险场景 (L1级) 资源推送
- **触发条件**：系统检测到轻度风险信号
- **推送形式**：温和的提醒和建议
- **推送内容**：自我关怀资源、放松练习、基础心理调适工具

### 3. 定期健康推送
基于用户行为模式和健康需求，定期推送：
- **每周一**：新的一周心理调适建议
- **每周三**：中期压力管理提醒
- **每周五**：周末放松和社交活动建议
- **每月初**：心理健康月度计划和回顾

### 4. 个性化推荐机制
系统根据用户画像和行为数据，实现精准推荐：
- **情绪标签匹配**：基于历史情绪数据推荐相关资源
- **行为模式分析**：根据任务完成情况和资源使用反馈优化推荐
- **时间场景感知**：结合时间段（考试周、假期等）调整推送内容
- **用户反馈学习**：基于用户对资源的评价和收藏持续优化算法

### 5. 资源交互功能
用户可以对推送资源进行多种交互：
- **立即查看**：点击推送通知直接打开资源详情
- **收藏管理**：将有用资源收藏到个人资源库
- **效果反馈**：对资源帮助程度进行评分（1-5星）
- **分享功能**：将资源分享给朋友（在授权范围内）
- **稍后查看**：将资源加入待看列表

## 界面元素

### 推送通知组件
- **推送卡片**：包含资源标题、类型图标、简介、预览图
- **个性化标签**：显示"为你推荐"、"热门资源"、"同类用户也在看"等标签
- **操作按钮**："立即查看"、"收藏"、"不感兴趣"等快捷操作

### 资源详情页
- **资源展示**：视频播放器、文章阅读器、音乐播放器等
- **相关信息**：资源分类标签、使用时长、难度等级
- **推荐理由**：说明为什么推荐这个资源给用户
- **相关资源**：展示同类或系列资源推荐

### 个人资源库
- **收藏管理**：用户收藏的资源列表，支持分类筛选
- **使用记录**：资源查看历史和使用统计
- **偏好设置**：资源推送偏好设置（类型、频率、时段）

## 数据需求

### 资源数据
- `resources`：资源库表，包含资源ID、类型、标题、描述、内容、标签
- `resource_categories`：资源分类表，管理资源类型和层级关系
- `resource_tags`：资源标签表，支持多维度标签体系

### 推送数据
- `push_recommendations`：推送记录表，记录推送时间、资源、用户、触发原因
- `user_preferences`：用户偏好表，存储用户对资源类型的偏好设置
- `push_feedback`：反馈数据表，记录用户对推送的交互和评价

### 分析数据
- `resource_analytics`：资源使用分析表，统计资源使用效果
- `recommendation_metrics`：推荐算法指标表，跟踪推荐准确性和用户满意度
- `user_engagement`：用户参与度表，分析用户与推送资源的互动情况

## 推送策略

### 触发条件
1. **情绪触发**：情绪打卡检测到特定情绪状态
2. **风险触发**：风险等级达到预设阈值
3. **时间触发**：定期健康推送和特殊时间点
4. **行为触发**：用户行为模式变化（如连续多天未完成任务）
5. **系统触发**：新资源上线或系统功能更新

### 推送规则
- **频率控制**：同一用户每日最多推送3次，避免过度打扰
- **内容去重**：避免短时间内推送相似内容
- **时间窗口**：尊重用户设置的免打扰时间段
- **质量优先**：优先推送高评分、高相关性的资源
- **个性化权重**：基于用户历史反馈调整推荐权重

### 效果评估
- **打开率**：推送通知的点击打开比例
- **完播率**：视频/音频资源的完整观看比例
- **收藏率**：资源被收藏的比例
- **评分均值**：用户对资源的评分统计
- **转化率**：资源使用后用户情绪改善的比例

## 技术实现

### 推荐算法
1. **协同过滤**：基于相似用户的行为数据进行推荐
2. **内容推荐**：基于资源标签和用户偏好匹配
3. **场景推荐**：基于时间、场景、情绪状态的上下文推荐
4. **混合推荐**：结合多种算法的综合推荐策略

### 数据处理
- **实时计算**：用户情绪打卡和风险预警的实时推送
- **批量处理**：定期健康推送的批量计算和发送
- **离线分析**：用户行为数据的离线分析和模型训练
- **A/B测试**：不同推送策略的效果对比和优化

## 隐私保护

### 数据安全
- **匿名化处理**：用户行为数据匿名化，保护个人隐私
- **最小权限**：仅收集必要的推荐相关数据
- **加密存储**：敏感数据加密存储，防止泄露
- **访问控制**：严格的数据访问权限控制

### 用户控制
- **推送开关**：用户可以完全关闭推送功能
- **偏好设置**：用户可以设置推送类型和频率偏好
- **反馈机制**：用户可以对推送内容进行评价和反馈
- **数据导出**：用户可以导出自己的偏好和使用数据

## 后续优化

### 功能扩展
1. **智能对话推荐**：在AI对话中实时推荐相关资源
2. **社交推荐**：基于好友关系的资源分享和推荐
3. **专家推荐**：心理专家精选和推荐的资源
4. **场景化推荐**：基于特定场景（如考试、求职）的专项资源包

### 算法优化
1. **深度学习**：引入深度学习模型提升推荐准确性
2. **多目标优化**：同时优化推荐准确性、多样性和新颖性
3. **实时反馈**：基于用户实时反馈动态调整推荐策略
4. **跨平台整合**：整合多平台数据，构建更完整的用户画像