# MindGuard 《总计划-里程碑与时间线》

## 1. 里程碑范围与目标
### M0 准备（Sprint 1，Week 1-2）
- 目标：完成项目启动、需求基线与云开发环境搭建，为后续迭代打下稳定基础。
- 关键范围：确认五个 Tab 的用户旅程与功能优先级；冻结分包规划与数据库命名规范；配置微信云开发环境、代码仓库、集成 CI 基线。
- 重点输出：版本计划、需求澄清记录、`app.json` 主包&分包骨架草案、研发/测试账号、风险清单草稿。

### M1 骨架与首页（Sprint 2，Week 3-4）
- 目标：搭建主包页面骨架，交付可交互的“今天”首页，实现情绪打卡→微建议→任务生成的最小闭环。
- 关键范围：实现 tabBar（今天｜任务｜树洞｜心情随笔｜我的）与主包页面路由；交付今天页核心组件（情绪状态卡、Top3 微建议、一键任务写入任务清单 mock）；对接云函数/集合的读写沙盒；完成首页埋点雏形。
- 重点输出：`pages/today/index` 首屏骨架、公共组件库雏形、情绪打卡与任务生成 API 联调脚手架、体验版基线包。

### M2 核心流程（打卡/心情随笔/任务/树洞）（Sprint 3-4，Week 5-8）
- 目标：完成三个核心闭环：情绪打卡→任务执行、心情随笔记录→复盘→任务同步、树洞互动→行动卡任务同步。
- 关键范围：完善任务卡执行闭环（状态同步 tasks/checkins）；交付心情随笔 Tab 的随笔/清单双视图与多模录入 REBT 模板、情绪趋势；实现树洞发帖、风险提示、行动卡领取并写入清单；完成相关云函数（`taskReceipt`、`syncActionCardTask`）与集合联调；补齐高频埋点。
- 重点输出：核心流程端到端 Demo（含分包调用）、埋点事件验证日志、T+1 复盘提醒策略草案、体验环境全链路自测报告。

### M3 扩展与风控（Sprint 5，Week 9-10）
- 目标：加强社区风控、夜间策略与运营能力，补齐性能与安全保障。
- 关键范围：上线树洞风险提示、资源跳转与温和关怀流程；配置 SOS 独立分包与守护链路；完善晚安模式、护心周报摘要与徽章触达；接入风险监控、慢查询报警、埋点看板；准备审核所需的风控与合规材料。
- 重点输出：`packages/community` 风控能力、`independent/sos` 独立分包、夜间提醒策略、Grafana/看板初版、审核资料包初稿。

### M4 提审与发布（Sprint 6，Week 11-12）
- 目标：完成全面测试、资料准备与微信小程序提审、上线。
- 关键范围：执行端到端测试（功能、性能、风控）；完成埋点验收、数据库索引巡检；准备提审截图、体验版说明、客服资质；走完发布 checklist 与回滚预案演练。
- 重点输出：提审包、体验版测试报告、审核资料归档、回滚脚本与版本快照、上线公告草案。

### M5 运营与复盘（Sprint 7，Week 13-14）
- 目标：支撑上线后的运营推广、监控与项目复盘，闭合数据与体验循环。
- 关键范围：执行上线 48h 值班、监控指标与用户反馈；汇总埋点看板、社区健康、任务完成率；整理复盘文档、运营策略、需求池；规划下一阶段迭代。
- 重点输出：上线日报、指标汇总看板、运营物料包（推送文案、校园渠道计划）、项目复盘报告、后续 backlog 草案。

## 2. 2 周迭代时间线与 DoR/DoD
| 里程碑 | 所属 Sprint | 时间范围 | DoR（进入条件） | DoD（退出条件） |
| --- | --- | --- | --- | --- |
| M0 准备 | Sprint 1 | Week 1-2 | 核心成员到位；五个 Tab 用户流程、功能列表评审通过；云开发环境和代码仓库可访问 | 微信云开发环境可编译；分包规划冻结；需求基线文档与风险清单发布；CI 初版跑通 |
| M1 骨架与首页 | Sprint 2 | Week 3-4 | M0 DoD 完成；UI 关键稿件与组件规范确认；接口占位文档对今天页接口达成一致 | 主包四页骨架可运行；今天页情绪打卡→微建议→任务写入完成端到端演示；tabBar 和埋点 `pv_today`、`mood_checkin_submit` 可上报；首版体验包提测 |
| M2 核心流程 | Sprint 3-4 | Week 5-8 | M1 DoD 完成；核心云函数（`taskReceipt`、`syncActionCardTask`）与数据库 Schema 冻结；心情随笔/树洞交互稿确认 | 今天/任务/树洞/心情随笔核心流程真机可用；`tasks`、`checkins`、`journals`、`posts` 集合读写验收；分包 journal/community 可按需加载；埋点核心漏斗跑通；联调缺陷关闭率≥95% |
| M3 扩展与风控 | Sprint 5 | Week 9-10 | M2 DoD 完成；风控策略与 SOS 流程脚本审定；埋点分析环境可追溯 | 风控提示、SOS 独立分包、晚安模式上线测试环境；风险/性能监控指标达标；审核资料（截图、功能介绍、资质）初稿归档；风控演练记录通过 |
| M4 提审与发布 | Sprint 6 | Week 11-12 | M3 DoD 完成；提审 checklist 审阅；测试环境缺陷关闭 | 全量测试通过并归档报告；审核资料提交运营确认；微信提审提交且通过；回滚预案演练记录；正式版发布窗口确定 |
| M5 运营与复盘 | Sprint 7 | Week 13-14 | M4 DoD 完成；运营渠道准备就绪；监控告警阈值配置完成 | 上线 48h 运营值班记录；关键指标日报/周报发布；用户反馈与缺陷跟踪列表；项目复盘与下一阶段 backlog 归档 |

## 3. 关键依赖
- **云函数**：`taskReceipt`（任务回执写入 `checkins`）、`syncActionCardTask`（树洞行动卡同步任务）、`generateWeeklyReport`（护心周报统计）、`schemaValidator`/`migrationRunner`（数据库校验与迁移）、`pushGuardianAlert`（SOS 守护通知）。需在 M1-M3 期间完成接口契约与自动化测试。
- **数据库集合**：`users`、`tasks`、`checkins`、`journals`、`posts`、`sos`、`suggestions`、`notifications` 等遵循《索引与约定.md》命名/权限策略；索引（如 `[user_id, status, due_at]`、`[user_id, checkin_date]`）必须在 M2 前建成以支撑高频查询。
- **分包路由**：主包 `pages/today|diary|treehole|mine`，分包 `packages/journal|community|profile` 与独立分包 `independent/sos` 按《分包规划方案.md》配置；M1 完成主包骨架，M2-M3 完成分包联调与预加载策略。
- **埋点方案**：依据《埋点与数据分析.md》实现事件与参数，M1 完成今天页基础事件，M2 覆盖闭环行为，M3 上线风险与运营指标；需同步数据团队配置 ClickHouse/Superset 看板。
- **审核资料**：沿《上线说明.md》准备 AppID、合法域名、隐私合规材料、提审截图、体验账号；M3 输出初稿，M4 定稿并由运营提交微信审核。

## 4. 可交付物清单
- **代码资产**：主包与分包页面代码、公共组件库、云函数脚本、配置文件（`app.json`、环境变量）、构建脚本、测试用例。
- **文档资产**：需求说明、接口契约、埋点文档、部署/回滚手册、值班手册、提审资料包、项目复盘报告。
- **数据脚本与配置**：数据库初始化/迁移脚本、索引配置、体验账号数据集、预置埋点验证脚本、监控与报警配置。
- **验收记录**：自测/联测/回归测试报告、埋点验收记录、风控演练纪要、提审审核反馈、上线 checklist、值班记录。
- **回滚资产**：历史编译包、数据库备份/快照、回滚脚本、紧急公告模板、异常响应预案。

## 5. 路线图甘特（2 周粒度）
| 里程碑 | Sprint | 起始周 | 结束周 | 负责人（占位） | 关键输出 |
| --- | --- | --- | --- | --- | --- |
| M0 准备 | Sprint 1 | Week 1 | Week 2 | 产品负责人 / 技术负责人 | 启动会、环境搭建、需求基线、风险清单 |
| M1 骨架与首页 | Sprint 2 | Week 3 | Week 4 | 前端负责人 | 主包骨架、今天页 MVP、首页埋点、体验包 |
| M2 核心流程 | Sprint 3-4 | Week 5 | Week 8 | 前端 & 后端双负责人 | 核心流程联调、分包加载、云函数上线、埋点漏斗 |
| M3 扩展与风控 | Sprint 5 | Week 9 | Week 10 | 风控负责人 | 风控策略、SOS 分包、监控告警、审核资料初稿 |
| M4 提审与发布 | Sprint 6 | Week 11 | Week 12 | 测试 & 运营负责人 | 全量测试、提审包、回滚预案、发布确认 |
| M5 运营与复盘 | Sprint 7 | Week 13 | Week 14 | 运营负责人 | 上线值班、指标看板、运营物料、项目复盘 |



