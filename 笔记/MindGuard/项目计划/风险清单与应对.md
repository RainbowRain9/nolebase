# MindGuard 《风险清单与应对》

## 1. 风险分类与条目

### 1.1 需求变更
- **描述**：里程碑期间新增或调整关键功能（如今天页核心交互、树洞风控策略）导致范围膨胀。
- **触发信号**：单个 Sprint 内新增 P0/P1 需求 ≥2 个；需求基线外新增工作量 > 15%。
- **概率×影响**：中 × 高。
- **应对策略**：减轻（变更评审）、转移（延后至下一里程碑）。
- **预案 SOP**：
  1. PO 发起变更评审（含影响评估、资源核算）。
  2. Tech Lead/PMO 评估对关键路径的影响，必要时调整 WBS。
  3. 评审结论记录于需求基线文档并同步每日站会。

### 1.2 接口延迟
- **描述**：核心 API/云函数（/api/moods/today、/api/journals、taskReceipt 等）上线延迟或性能不达标。
- **触发信号**：后端交付延迟 > 2 个工作日；接口 P95 响应时间 > 1.5s；错误率 > 1%。
- **概率×影响**：中 × 高。
- **应对策略**：减轻（提前联调）、接受（短期降级）。
- **预案 SOP**：
  1. BE Lead 每日检查接口进度与监控；延迟预警同步到看板。
  2. 前端准备 mock 数据、自定义降级逻辑；QA 提前设计降级测试用例。
  3. 若性能持续不达标，Tech Lead 组织性能诊断会，必要时调整架构（缓存、批量）。

### 1.3 审核被拒
- **描述**：微信小程序提审因功能敏感、资料缺失被驳回。
- **触发信号**：审核资料未在提审前冻结；提审后 24h 未收到审核通过；审核驳回原因涉及合规或功能缺失。
- **概率×影响**：中 × 高。
- **应对策略**：规避（提前准备资料）、减轻（驳回复盘）。
- **预案 SOP**：
  1. Ops/Risk Lead 在 M3 完成资料初稿，M4 冻结版本。
  2. 提审前 QA 输出阻断项确认清单；PMO 核对提审流程。
  3. 若被拒，24h 内完成驳回点整改计划并补充资料。

### 1.4 性能与包体
- **描述**：首包体积超标或今天页首屏渲染超过预算，影响上线审核与用户体验。
- **触发信号**：主包体积 > 2 MB；首屏渲染时间 > 1.5s；页面白屏率 > 2%。
- **概率×影响**：中 × 高。
- **应对策略**：规避（资源拆分）、减轻（性能优化）。
- **预案 SOP**：
  1. FE Lead 每周检查构建产物体积与性能报告。
  2. 超出阈值时，立即执行资源拆分（图像 CDN、组件懒加载）。
  3. QA 在提测阶段开展性能回归，记录优化纪要。

### 1.5 隐私合规
- **描述**：隐私中心、数据导出、隐私政策未对齐微信与校方要求，导致合规风险。
- **触发信号**：隐私协议版本未更新；敏感字段未脱敏；合规部门审查未通过。
- **概率×影响**：低 × 高。
- **应对策略**：规避（提前审查）、减轻（补充协议）。
- **预案 SOP**：
  1. Ops/Risk Lead 与合规团队在 M3 前审阅隐私文档。
  2. Data Lead 确认敏感字段遵守隐私级别约定；QA 在我的 Tab 测试撤销与审计功能。
  3. 若发现缺口，24h 内补充协议并更新上线说明。

### 1.6 数据一致性
- **描述**：tasks、checkins、journals、reports 等关键集合存在写入失败、重复或延迟导致闭环断裂。
- **触发信号**：核心集合写入失败率 > 1%；埋点与数据库指标不一致 > 5%；周报生成失败次数 ≥ 2。
- **概率×影响**：中 × 高。
- **应对策略**：减轻（监控、重试）、接受（短期补偿）。
- **预案 SOP**：
  1. BE Lead 配置云函数重试与告警；Data Lead 交叉核对埋点与数据库。
  2. 发现异常时启动数据修复脚本（migrationRunner）；记录补偿方案。
  3. 重大数据错误由 Tech Lead 组织复盘并更新 SOP。

### 1.7 分包路由错配
- **描述**：主包与分包路径配置错误导致页面无法加载或跨包路由失败。
- **触发信号**：体验版真机出现页面加载失败；`app.json` 与分包规划不一致；预加载命中率 < 80%。
- **概率×影响**：中 × 中。
- **应对策略**：规避（自动校验）、减轻（修复脚本）。
- **预案 SOP**：
  1. FE Lead 在每次发布前运行路由校验脚本，比对《分包规划方案》。
  2. QA 真机巡检所有分页面与独立分包加载。
  3. 发现错配时，PMO 立即冻结发布，修正配置后重新提测。

### 1.8 埋点缺失
- **描述**：关键事件（pv_today、mood_checkin_submit 等）缺失或参数异常，影响漏斗与风控判断。
- **触发信号**：关键事件日环比下降 > 20%；ClickHouse/看板缺失事件；埋点校验脚本失败。
- **概率×影响**：中 × 中。
- **应对策略**：减轻（自动校验）、接受（少量缺失补发）。
- **预案 SOP**：
  1. Data Lead 每周执行埋点校验脚本，QA 于提测阶段验证事件。
  2. 缺失事件由开发提供热修方案或手动补发；记录埋点缺口清单。
  3. 周报中标注数据可信度，必要时调整指标读取逻辑。

## 2. 红线指标
| 指标 | 红线值 | 监控责任人 | 检测频率 | 触发处理 |
| --- | --- | --- | --- | --- |
| 首包体积上限 | ≤ 2 MB | FE Lead | 每周构建 | 超标立即执行资源拆分并复测 |
| 首屏渲染预算 | ≤ 1.5s（首屏 TTI） | FE Lead、QA Lead | 每次提测 & 真机巡检 | 超预算需提交性能优化方案和复测报告 |
| 接口错误率 | ≤ 1%（核心接口 5xx/业务错误） | BE Lead、Ops/Risk Lead | 实时监控（APM） | 超阈值触发性能诊断会，必要时降级 |
| 提审前阻断项清单 | 必须全部关闭：P0/P1 缺陷、隐私协议缺失、风控演练未完成 | PMO、QA Lead、Ops/Risk Lead | 提审前一次性核对 | 若未达成，提审延期，列明整改计划 |

## 3. 附录：责任矩阵参考
- 需求变更、审核被拒：PO、PMO、Ops/Risk Lead。
- 接口延迟、性能与包体：Tech Lead、FE Lead、BE Lead。
- 隐私合规、数据一致性：Ops/Risk Lead、Data Lead、BE Lead。
- 分包路由错配、埋点缺失：FE Lead、QA Lead、Data Lead。